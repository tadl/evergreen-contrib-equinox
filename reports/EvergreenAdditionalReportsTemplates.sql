/*
 * Copyright (C) 2010-2013 Equinox Software, Inc.
 *
 * Additional Evergreen report templates.
 *
 * Reports created by Shae Tetterton <shae@esilibrary.com>
 * Packaged by Steven Callender <stevecallender@esilibrary.com>
 *
 * Equinox gratefully acknowledges the King County Library System
 * for sponsoring and testing these reports.
 *
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation; either version 2
 * of the License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 */

--
-- Load new Report Templates for 1.6
-- Data for Name: template_folder; Type: TABLE DATA; Schema: reporter; Owner: -
-- Make sure you do not already have a Reports Project folder, otherwise these reports will be added to it. 
--

BEGIN;

SET client_encoding = 'UTF8';
SET standard_conforming_strings = off;
SET check_function_bodies = false;
SET client_min_messages = warning;
SET escape_string_warning = off;

-- Create Template Folders

INSERT INTO reporter.template_folder (parent, "owner", create_time, name, shared, share_with) VALUES (NULL, 1, now(), 'EG Custom Reports', true, 1);
INSERT INTO reporter.template_folder (parent, "owner", create_time, name, shared, share_with) VALUES ((select id from reporter.template_folder where name='EG Custom Reports' and parent is null), 1, now(), 'Circulation Reports', true, 1);
INSERT INTO reporter.template_folder (parent, "owner", create_time, name, shared, share_with) VALUES ((select id from reporter.template_folder where name='EG Custom Reports' and parent is null), 1, now(), 'Acquisitions', true, 1);


--
-- Data for Name: template; Type: TABLE DATA; Schema: reporter; Owner: -
--

-- Create Templates

INSERT INTO reporter.template ("owner", create_time, name, description, data, folder) VALUES (1, now(), 'Hourly Checkouts', 'Hourly Checkouts -  This report shows checkout, grouped by workstation library and name and divided by date and hour. Filters by checkout date range and workstation library.', '{"version":3,"core_class":"circ","select":[{"alias":"Workstation Library","column":{"colname":"name","transform":"Bare","transform_label":"Raw Data"},"path":"circ-workstation-aws-owning_lib-aou-name","relation":"8df8113346fefc52aa9b43a53c7305b7"},{"alias":"Workstation Name","column":{"colname":"name","transform":"Bare","transform_label":"Raw Data"},"path":"circ-workstation-aws-name","relation":"cb720e383a265d85a54487cf6e11277f"},{"alias":"Date","column":{"colname":"xact_start","transform":"date","transform_label":"Date"},"path":"circ-billable_transaction-mbt-xact_start","relation":"3edc6485c4309dbf7d1d4db1bc653667"},{"alias":"Hour of Day","column":{"colname":"xact_start","transform":"hour_trunc","transform_label":"Hour"},"path":"circ-xact_start","relation":"f45381a54504218e39aca33492d29306"},{"alias":"Circulations","column":{"colname":"id","transform":"count","transform_label":"Count"},"path":"circ-id","relation":"f45381a54504218e39aca33492d29306"}],"from":{"path":"circ-workstation","table":"action.circulation","label":"Circulation","alias":"f45381a54504218e39aca33492d29306","idlclass":"circ","template_path":"circ","join":{"workstation-f45381a54504218e39aca33492d29306":{"key":"id","path":"circ-workstation-aws","table":"actor.workstation","alias":"cb720e383a265d85a54487cf6e11277f","join":{"owning_lib-05073cb8dd74bd0c237763b7b4739286":{"key":"id","path":"circ-workstation-aws-owning_lib-aou","table":"actor.org_unit","label":"Circulation -> Workstation :: Owning Library","alias":"8df8113346fefc52aa9b43a53c7305b7","idlclass":"aou","template_path":"circ-workstation.aws-owning_lib"}},"label":"Circulation :: Workstation","idlclass":"aws","template_path":"circ-workstation"},"id-mbt-id-f45381a54504218e39aca33492d29306":{"key":"id","type":"left","path":"circ-billable_transaction-mbt","table":"money.billable_xact","label":"Circulation :: Base Transaction","alias":"3edc6485c4309dbf7d1d4db1bc653667","idlclass":"mbt","template_path":"circ-billable_transaction"}}},"where":[{"alias":"Check Out Date/Time","column":{"colname":"xact_start","transform":"date","transform_label":"Date"},"path":"circ-xact_start","relation":"f45381a54504218e39aca33492d29306","condition":{"between":"::P0"}},{"alias":"Organizational Unit ID","column":{"colname":"id","transform":"Bare","transform_label":"Raw Data"},"path":"circ-workstation-aws-owning_lib-aou-id","relation":"8df8113346fefc52aa9b43a53c7305b7","condition":{"in":"::P1"}}],"having":[],"order_by":[],"rel_cache":{"order_by":[{"relation":"8df8113346fefc52aa9b43a53c7305b7","field":"name"},{"relation":"cb720e383a265d85a54487cf6e11277f","field":"name"},{"relation":"3edc6485c4309dbf7d1d4db1bc653667","field":"xact_start"},{"relation":"f45381a54504218e39aca33492d29306","field":"xact_start"},{"relation":"f45381a54504218e39aca33492d29306","field":"id"}],"f45381a54504218e39aca33492d29306":{"label":"Circulation","alias":"f45381a54504218e39aca33492d29306","path":"circ","join":"","reltype":"","idlclass":"circ","table":"action.circulation","fields":{"dis_tab":{"xact_start":{"colname":"xact_start","transform":"hour_trunc","aggregate":null,"params":null,"transform_label":"Hour","alias":"Hour of Day","join":"","datatype":"timestamp","op":"=","op_label":"Equals","op_value":{}},"id":{"colname":"id","transform":"count","aggregate":true,"params":null,"transform_label":"Count","alias":"Circulations","join":"","datatype":"id","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{"xact_start":{"colname":"xact_start","transform":"date","aggregate":null,"params":null,"transform_label":"Date","alias":"Check Out Date/Time","join":"","datatype":"timestamp","op":"between","op_label":"Between","op_value":{}}},"aggfilter_tab":{}}},"8df8113346fefc52aa9b43a53c7305b7":{"label":"Circulation -> Workstation :: Owning Library","alias":"8df8113346fefc52aa9b43a53c7305b7","path":"circ-workstation.aws-owning_lib","join":"","reltype":"has_a","idlclass":"aou","table":"actor.org_unit","fields":{"dis_tab":{"name":{"colname":"name","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Workstation Library","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{"id":{"colname":"id","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Organizational Unit ID","join":"","datatype":"org_unit","op":"in","op_label":"In list","op_value":{}}},"aggfilter_tab":{}}},"3edc6485c4309dbf7d1d4db1bc653667":{"label":"Circulation :: Base Transaction","alias":"3edc6485c4309dbf7d1d4db1bc653667","path":"circ-billable_transaction","join":"","reltype":"might_have","idlclass":"mbt","table":"money.billable_xact","fields":{"dis_tab":{"xact_start":{"colname":"xact_start","transform":"date","aggregate":null,"params":null,"transform_label":"Date","alias":"Date","join":"","datatype":"timestamp","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{},"aggfilter_tab":{}}},"cb720e383a265d85a54487cf6e11277f":{"label":"Circulation :: Workstation","alias":"cb720e383a265d85a54487cf6e11277f","path":"circ-workstation","join":"","reltype":"has_a","idlclass":"aws","table":"actor.workstation","fields":{"dis_tab":{"name":{"colname":"name","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Workstation Name","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{},"aggfilter_tab":{}}}}}', (select f.id from reporter.template_folder f JOIN reporter.template_folder ff on (f.parent = ff.id) where ff.name='EG Custom Reports' and f.name='Circulation Reports'));
INSERT INTO reporter.template ("owner", create_time, name, description, data, folder) VALUES (1, now(), 'Hourly Checkins', 'Hourly Checkins -  This report shows checkins, grouped by workstation library and name and divided by date and hour. Filters by checkin date range and workstation library.', '{"version":3,"core_class":"circ","select":[{"alias":"Workstation Library","column":{"colname":"name","transform":"Bare","transform_label":"Raw Data"},"path":"circ-checkin_lib-aou-name","relation":"64aebcf0b128cf6906843c3d716fadc2"},{"alias":"Workstation Name","column":{"colname":"name","transform":"Bare","transform_label":"Raw Data"},"path":"circ-checkin_lib-aou-workstations-aws-name","relation":"d7b9968944212ae368f35a6f2600ee52"},{"alias":"Date","column":{"colname":"xact_start","transform":"date","transform_label":"Date"},"path":"circ-billable_transaction-mbt-xact_start","relation":"3edc6485c4309dbf7d1d4db1bc653667"},{"alias":"Hour of Day","column":{"colname":"checkin_time","transform":"hod","transform_label":"Hour of day"},"path":"circ-checkin_time","relation":"f45381a54504218e39aca33492d29306"},{"alias":"Checkins","column":{"colname":"id","transform":"count","transform_label":"Count"},"path":"circ-id","relation":"f45381a54504218e39aca33492d29306"}],"from":{"path":"circ-checkin_lib","table":"action.circulation","label":"Circulation","alias":"f45381a54504218e39aca33492d29306","idlclass":"circ","template_path":"circ","join":{"id-mbt-id-f45381a54504218e39aca33492d29306":{"key":"id","type":"left","path":"circ-billable_transaction-mbt","table":"money.billable_xact","label":"Circulation :: Base Transaction","alias":"3edc6485c4309dbf7d1d4db1bc653667","idlclass":"mbt","template_path":"circ-billable_transaction"},"checkin_lib-f45381a54504218e39aca33492d29306":{"key":"id","path":"circ-checkin_lib-aou-workstations","table":"actor.org_unit","label":"Circulation :: Check In Library","alias":"64aebcf0b128cf6906843c3d716fadc2","idlclass":"aou","template_path":"circ-checkin_lib","type":"left","join":{"id-aws-owning_lib-64aebcf0b128cf6906843c3d716fadc2":{"type":"left","key":"owning_lib","path":"circ-checkin_lib-aou-workstations-aws","table":"actor.workstation","label":"Circulation -> Organizational Unit :: Workstations","alias":"d7b9968944212ae368f35a6f2600ee52","idlclass":"aws","template_path":"circ-checkin_lib.aou-workstations"}}}}},"where":[{"alias":"Check In Date/Time","column":{"colname":"checkin_time","transform":"date","transform_label":"Date"},"path":"circ-checkin_time","relation":"f45381a54504218e39aca33492d29306","condition":{"between":"::P0"}},{"alias":"Organizational Unit ID","column":{"colname":"id","transform":"Bare","transform_label":"Raw Data"},"path":"circ-checkin_lib-aou-id","relation":"64aebcf0b128cf6906843c3d716fadc2","condition":{"in":"::P1"}}],"having":[],"order_by":[],"rel_cache":{"order_by":[{"relation":"64aebcf0b128cf6906843c3d716fadc2","field":"name"},{"relation":"d7b9968944212ae368f35a6f2600ee52","field":"name"},{"relation":"3edc6485c4309dbf7d1d4db1bc653667","field":"xact_start"},{"relation":"f45381a54504218e39aca33492d29306","field":"checkin_time"},{"relation":"f45381a54504218e39aca33492d29306","field":"id"}],"f45381a54504218e39aca33492d29306":{"label":"Circulation","alias":"f45381a54504218e39aca33492d29306","path":"circ","join":"","reltype":"","idlclass":"circ","table":"action.circulation","fields":{"dis_tab":{"id":{"colname":"id","transform":"count","aggregate":true,"params":null,"transform_label":"Count","alias":"Checkins","join":"","datatype":"id","op":"=","op_label":"Equals","op_value":{}},"checkin_time":{"colname":"checkin_time","transform":"hod","aggregate":null,"params":null,"transform_label":"Hour of day","alias":"Hour of Day","join":"","datatype":"timestamp","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{"checkin_time":{"colname":"checkin_time","transform":"date","aggregate":null,"params":null,"transform_label":"Date","alias":"Check In Date/Time","join":"","datatype":"timestamp","op":"between","op_label":"Between","op_value":{}}},"aggfilter_tab":{}}},"3edc6485c4309dbf7d1d4db1bc653667":{"label":"Circulation :: Base Transaction","alias":"3edc6485c4309dbf7d1d4db1bc653667","path":"circ-billable_transaction","join":"","reltype":"might_have","idlclass":"mbt","table":"money.billable_xact","fields":{"dis_tab":{"xact_start":{"colname":"xact_start","transform":"date","aggregate":null,"params":null,"transform_label":"Date","alias":"Date","join":"","datatype":"timestamp","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{},"aggfilter_tab":{}}},"64aebcf0b128cf6906843c3d716fadc2":{"label":"Circulation :: Check In Library","alias":"64aebcf0b128cf6906843c3d716fadc2","path":"circ-checkin_lib","join":"","reltype":"has_a","idlclass":"aou","table":"actor.org_unit","fields":{"dis_tab":{"name":{"colname":"name","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Workstation Library","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{"id":{"colname":"id","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Organizational Unit ID","join":"","datatype":"org_unit","op":"in","op_label":"In list","op_value":{}}},"aggfilter_tab":{}}},"d7b9968944212ae368f35a6f2600ee52":{"label":"Circulation -> Organizational Unit :: Workstations","alias":"d7b9968944212ae368f35a6f2600ee52","path":"circ-checkin_lib.aou-workstations","join":"","reltype":"has_many","idlclass":"aws","table":"actor.workstation","fields":{"dis_tab":{"name":{"colname":"name","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Workstation Name","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{},"aggfilter_tab":{}}}}}', (select f.id from reporter.template_folder f JOIN reporter.template_folder ff on (f.parent = ff.id) where ff.name='EG Custom Reports' and f.name='Circulation Reports'));
INSERT INTO reporter.template ("owner", create_time, name, description, data, folder) VALUES (1, now(), 'Checkout Statistics by Circulating Library', 'Checkout Stats by Circulating Library -  This report shows checkout data by circulating location (library) and workstation name, filtered by date range (month) and owning library. With specific dates as a filter, you may include previous month and same month previous year.', '{"version":3,"core_class":"circ","select":[{"alias":"Month","column":{"colname":"xact_start","transform":"month_trunc","transform_label":"Year + Month"},"path":"circ-xact_start","relation":"f45381a54504218e39aca33492d29306"},{"alias":"Circulating Library","column":{"colname":"name","transform":"Bare","transform_label":"Raw Data"},"path":"circ-circ_lib-aou-name","relation":"0dedf4f8c60c2d21e02de82082a7f62b"},{"alias":"Circulation Count","column":{"colname":"id","transform":"count","transform_label":"Count"},"path":"circ-id","relation":"f45381a54504218e39aca33492d29306"}],"from":{"path":"circ-circ_lib","table":"action.circulation","label":"Circulation","alias":"f45381a54504218e39aca33492d29306","idlclass":"circ","template_path":"circ","join":{"circ_lib-f45381a54504218e39aca33492d29306":{"key":"id","path":"circ-circ_lib-aou","table":"actor.org_unit","label":"Circulation :: Circulating Library","alias":"0dedf4f8c60c2d21e02de82082a7f62b","idlclass":"aou","template_path":"circ-circ_lib"}}},"where":[{"alias":"Check Out Date/Time","column":{"colname":"xact_start","transform":"month_trunc","transform_label":"Year + Month"},"path":"circ-xact_start","relation":"f45381a54504218e39aca33492d29306","condition":{"in":"::P0"}},{"alias":"Organizational Unit ID","column":{"colname":"id","transform":"Bare","transform_label":"Raw Data"},"path":"circ-circ_lib-aou-id","relation":"0dedf4f8c60c2d21e02de82082a7f62b","condition":{"in":"::P1"}}],"having":[],"order_by":[],"rel_cache":{"order_by":[{"relation":"f45381a54504218e39aca33492d29306","field":"xact_start"},{"relation":"0dedf4f8c60c2d21e02de82082a7f62b","field":"name"},{"relation":"f45381a54504218e39aca33492d29306","field":"id"}],"f45381a54504218e39aca33492d29306":{"label":"Circulation","alias":"f45381a54504218e39aca33492d29306","path":"circ","join":"","reltype":"","idlclass":"circ","table":"action.circulation","fields":{"dis_tab":{"xact_start":{"colname":"xact_start","transform":"month_trunc","aggregate":null,"params":null,"transform_label":"Year + Month","alias":"Month","join":"","datatype":"timestamp","op":"=","op_label":"Equals","op_value":{}},"id":{"colname":"id","transform":"count","aggregate":true,"params":null,"transform_label":"Count","alias":"Circulation Count","join":"","datatype":"id","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{"xact_start":{"colname":"xact_start","transform":"month_trunc","aggregate":null,"params":null,"transform_label":"Year + Month","alias":"Check Out Date/Time","join":"","datatype":"timestamp","op":"in","op_label":"In list","op_value":{}}},"aggfilter_tab":{}}},"0dedf4f8c60c2d21e02de82082a7f62b":{"label":"Circulation :: Circulating Library","alias":"0dedf4f8c60c2d21e02de82082a7f62b","path":"circ-circ_lib","join":"","reltype":"has_a","idlclass":"aou","table":"actor.org_unit","fields":{"dis_tab":{"name":{"colname":"name","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Circulating Library","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{"id":{"colname":"id","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Organizational Unit ID","join":"","datatype":"org_unit","op":"in","op_label":"In list","op_value":{}}},"aggfilter_tab":{}}}}}', (select f.id from reporter.template_folder f JOIN reporter.template_folder ff on (f.parent = ff.id) where ff.name='EG Custom Reports' and f.name='Circulation Reports'));
INSERT INTO reporter.template ("owner", create_time, name, description, data, folder) VALUES (1, now(), 'Circulation (Placed Holds by Patron Group) Report', 'Circulation (Placed Holds) Report - This report shows the placed holds, grouped by workstation library and date range (month) for request date. Additional filter to run this report just for specific patron groups (staff versus patron placed holds).', '{"version":3,"core_class":"ahr","select":[{"alias":"Request Date","column":{"colname":"request_time","transform":"month_trunc","transform_label":"Year + Month"},"path":"ahr-request_time","relation":"3b0d7d05c65006de7b2ca20f5fe39690"},{"alias":"Workstation Library","column":{"colname":"name","transform":"Bare","transform_label":"Raw Data"},"path":"ahr-request_lib-aou-workstations-aws-owning_lib-aou-name","relation":"0656ea2fad6f0c97c8fb69f162717596"},{"alias":"# of Holds Filled","column":{"colname":"id","transform":"count","transform_label":"Count"},"path":"ahr-id","relation":"3b0d7d05c65006de7b2ca20f5fe39690"}],"from":{"path":"ahr-request_lib","table":"action.hold_request","label":"Hold Request","alias":"3b0d7d05c65006de7b2ca20f5fe39690","idlclass":"ahr","template_path":"ahr","join":{"requestor-3b0d7d05c65006de7b2ca20f5fe39690":{"key":"id","path":"ahr-requestor-au-profile","table":"actor.usr","alias":"7b5f37f34aa9c4e1749c40a45f91f782","join":{"profile-7b5f37f34aa9c4e1749c40a45f91f782":{"key":"id","path":"ahr-requestor-au-profile-pgt","table":"permission.grp_tree","label":"Hold Request -> ILS User :: Main (Profile) Permission Group","alias":"6a64bed13e7e06b3e51301a9e70e39ec","idlclass":"pgt","template_path":"ahr-requestor.au-profile"}}},"request_lib-3b0d7d05c65006de7b2ca20f5fe39690":{"key":"id","path":"ahr-request_lib-aou-workstations","table":"actor.org_unit","alias":"0b51934add031994ba3a8d3d2affb77e","join":{"id-aws-owning_lib-0b51934add031994ba3a8d3d2affb77e":{"key":"owning_lib","type":"left","path":"ahr-request_lib-aou-workstations-aws-owning_lib","table":"actor.workstation","alias":"978a7581e0c0b8891c7c8101eb1d470a","join":{"owning_lib-978a7581e0c0b8891c7c8101eb1d470a":{"type":"left","key":"id","path":"ahr-request_lib-aou-workstations-aws-owning_lib-aou","table":"actor.org_unit","label":"Hold Request -> Organizational Unit -> Workstation :: Owning Library","alias":"0656ea2fad6f0c97c8fb69f162717596","idlclass":"aou","template_path":"ahr-request_lib.aou-workstations.aws-owning_lib"}}}}}}},"where":[{"alias":"Request Date/Time","column":{"colname":"request_time","transform":"month_trunc","transform_label":"Year + Month"},"path":"ahr-request_time","relation":"3b0d7d05c65006de7b2ca20f5fe39690","condition":{"in":"::P0"}},{"alias":"Group ID","column":{"colname":"id","transform":"Bare","transform_label":"Raw Data"},"path":"ahr-requestor-au-profile-pgt-id","relation":"6a64bed13e7e06b3e51301a9e70e39ec","condition":{"in":"::P1"}}],"having":[],"order_by":[],"rel_cache":{"3b0d7d05c65006de7b2ca20f5fe39690":{"label":"Hold Request","alias":"3b0d7d05c65006de7b2ca20f5fe39690","path":"ahr","join":"","reltype":"","idlclass":"ahr","table":"action.hold_request","fields":{"dis_tab":{"id":{"colname":"id","transform":"count","aggregate":true,"params":null,"transform_label":"Count","alias":"# of Holds Filled","join":"","datatype":"id","op":"=","op_label":"Equals","op_value":{}},"request_time":{"colname":"request_time","transform":"month_trunc","aggregate":null,"params":null,"transform_label":"Year + Month","alias":"Request Date","join":"","datatype":"timestamp","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{"request_time":{"colname":"request_time","transform":"month_trunc","aggregate":null,"params":null,"transform_label":"Year + Month","alias":"Request Date/Time","join":"","datatype":"timestamp","op":"in","op_label":"In list","op_value":{}}},"aggfilter_tab":{}}},"order_by":[{"relation":"3b0d7d05c65006de7b2ca20f5fe39690","field":"request_time"},{"relation":"0656ea2fad6f0c97c8fb69f162717596","field":"name"},{"relation":"3b0d7d05c65006de7b2ca20f5fe39690","field":"id"}],"6a64bed13e7e06b3e51301a9e70e39ec":{"label":"Hold Request -> ILS User :: Main (Profile) Permission Group","alias":"6a64bed13e7e06b3e51301a9e70e39ec","path":"ahr-requestor.au-profile","join":"","reltype":"has_a","idlclass":"pgt","table":"permission.grp_tree","fields":{"dis_tab":{},"filter_tab":{"id":{"colname":"id","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Group ID","join":"","datatype":"id","op":"in","op_label":"In list","op_value":{}}},"aggfilter_tab":{}}},"0656ea2fad6f0c97c8fb69f162717596":{"label":"Hold Request -> Organizational Unit -> Workstation :: Owning Library","alias":"0656ea2fad6f0c97c8fb69f162717596","path":"ahr-request_lib.aou-workstations.aws-owning_lib","join":"","reltype":"has_a","idlclass":"aou","table":"actor.org_unit","fields":{"dis_tab":{"name":{"colname":"name","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Workstation Library","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{},"aggfilter_tab":{}}}}}', (select f.id from reporter.template_folder f JOIN reporter.template_folder ff on (f.parent = ff.id) where ff.name='EG Custom Reports' and f.name='Circulation Reports'));
INSERT INTO reporter.template ("owner", create_time, name, description, data, folder) VALUES (1, now(), 'Checkins Yearly', 'Checkins -  This report sums checkin statistics for a given year, grouped by workstation library and name.', '{"version":3,"core_class":"circ","select":[{"alias":"Workstation Library","column":{"colname":"name","transform":"Bare","transform_label":"Raw Data"},"path":"circ-workstation-aws-owning_lib-aou-name","relation":"8df8113346fefc52aa9b43a53c7305b7"},{"alias":"Workstation Name","column":{"colname":"name","transform":"Bare","transform_label":"Raw Data"},"path":"circ-workstation-aws-name","relation":"cb720e383a265d85a54487cf6e11277f"},{"alias":"# of Circulations","column":{"colname":"id","transform":"count","transform_label":"Count"},"path":"circ-id","relation":"f45381a54504218e39aca33492d29306"}],"from":{"path":"circ-workstation","table":"action.circulation","label":"Circulation","alias":"f45381a54504218e39aca33492d29306","idlclass":"circ","template_path":"circ","join":{"workstation-f45381a54504218e39aca33492d29306":{"key":"id","path":"circ-workstation-aws","table":"actor.workstation","alias":"cb720e383a265d85a54487cf6e11277f","join":{"owning_lib-05073cb8dd74bd0c237763b7b4739286":{"key":"id","path":"circ-workstation-aws-owning_lib-aou","table":"actor.org_unit","label":"Circulation -> Workstation :: Owning Library","alias":"8df8113346fefc52aa9b43a53c7305b7","idlclass":"aou","template_path":"circ-workstation.aws-owning_lib"}},"label":"Circulation :: Workstation","idlclass":"aws","template_path":"circ-workstation"}}},"where":[{"alias":"Check In Date/Time","column":{"colname":"checkin_time","transform":"year_trunc","transform_label":"Year"},"path":"circ-checkin_time","relation":"f45381a54504218e39aca33492d29306","condition":{"=":"::P0"}},{"alias":"Organizational Unit ID","column":{"colname":"id","transform":"Bare","transform_label":"Raw Data"},"path":"circ-workstation-aws-owning_lib-aou-id","relation":"8df8113346fefc52aa9b43a53c7305b7","condition":{"in":"::P1"}}],"having":[],"order_by":[],"rel_cache":{"f45381a54504218e39aca33492d29306":{"label":"Circulation","alias":"f45381a54504218e39aca33492d29306","path":"circ","join":"","reltype":"","idlclass":"circ","table":"action.circulation","fields":{"dis_tab":{"id":{"colname":"id","transform":"count","aggregate":true,"params":null,"transform_label":"Count","alias":"# of Circulations","join":"","datatype":"id","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{"checkin_time":{"colname":"checkin_time","transform":"year_trunc","aggregate":null,"params":null,"transform_label":"Year","alias":"Check In Date/Time","join":"","datatype":"timestamp","op":"=","op_label":"Equals","op_value":{}}},"aggfilter_tab":{}}},"order_by":[{"relation":"8df8113346fefc52aa9b43a53c7305b7","field":"name"},{"relation":"cb720e383a265d85a54487cf6e11277f","field":"name"},{"relation":"f45381a54504218e39aca33492d29306","field":"id"}],"8df8113346fefc52aa9b43a53c7305b7":{"label":"Circulation -> Workstation :: Owning Library","alias":"8df8113346fefc52aa9b43a53c7305b7","path":"circ-workstation.aws-owning_lib","join":"","reltype":"has_a","idlclass":"aou","table":"actor.org_unit","fields":{"dis_tab":{"name":{"colname":"name","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Workstation Library","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{"id":{"colname":"id","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Organizational Unit ID","join":"","datatype":"org_unit","op":"in","op_label":"In list","op_value":{}}},"aggfilter_tab":{}}},"cb720e383a265d85a54487cf6e11277f":{"label":"Circulation :: Workstation","alias":"cb720e383a265d85a54487cf6e11277f","path":"circ-workstation","join":"","reltype":"has_a","idlclass":"aws","table":"actor.workstation","fields":{"dis_tab":{"name":{"colname":"name","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Workstation Name","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{},"aggfilter_tab":{}}}}}', (select f.id from reporter.template_folder f JOIN reporter.template_folder ff on (f.parent = ff.id) where ff.name='EG Custom Reports' and f.name='Circulation Reports'));
INSERT INTO reporter.template ("owner", create_time, name, description, data, folder) VALUES (1, now(), 'Circulation Yearly', 'Circulation (Yearly) with Chart -  This report sums circulation statistics for a given year, grouped by workstation library and name.', '{"version":3,"core_class":"circ","select":[{"alias":"Workstation Library","column":{"colname":"name","transform":"Bare","transform_label":"Raw Data"},"path":"circ-workstation-aws-owning_lib-aou-name","relation":"8df8113346fefc52aa9b43a53c7305b7"},{"alias":"Workstation Name","column":{"colname":"name","transform":"Bare","transform_label":"Raw Data"},"path":"circ-workstation-aws-name","relation":"cb720e383a265d85a54487cf6e11277f"},{"alias":"# of Circulations","column":{"colname":"id","transform":"count","transform_label":"Count"},"path":"circ-id","relation":"f45381a54504218e39aca33492d29306"}],"from":{"path":"circ-workstation","table":"action.circulation","label":"Circulation","alias":"f45381a54504218e39aca33492d29306","idlclass":"circ","template_path":"circ","join":{"workstation-f45381a54504218e39aca33492d29306":{"key":"id","path":"circ-workstation-aws","table":"actor.workstation","alias":"cb720e383a265d85a54487cf6e11277f","join":{"owning_lib-05073cb8dd74bd0c237763b7b4739286":{"key":"id","path":"circ-workstation-aws-owning_lib-aou","table":"actor.org_unit","label":"Circulation -> Workstation :: Owning Library","alias":"8df8113346fefc52aa9b43a53c7305b7","idlclass":"aou","template_path":"circ-workstation.aws-owning_lib"}},"label":"Circulation :: Workstation","idlclass":"aws","template_path":"circ-workstation"}}},"where":[{"alias":"Check Out Date/Time","column":{"colname":"xact_start","transform":"year_trunc","transform_label":"Year"},"path":"circ-xact_start","relation":"f45381a54504218e39aca33492d29306","condition":{"=":"::P0"}},{"alias":"Organizational Unit ID","column":{"colname":"id","transform":"Bare","transform_label":"Raw Data"},"path":"circ-workstation-aws-owning_lib-aou-id","relation":"8df8113346fefc52aa9b43a53c7305b7","condition":{"in":"::P1"}}],"having":[],"order_by":[],"rel_cache":{"f45381a54504218e39aca33492d29306":{"label":"Circulation","alias":"f45381a54504218e39aca33492d29306","path":"circ","join":"","reltype":"","idlclass":"circ","table":"action.circulation","fields":{"dis_tab":{"id":{"colname":"id","transform":"count","aggregate":true,"params":null,"transform_label":"Count","alias":"# of Circulations","join":"","datatype":"id","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{"xact_start":{"colname":"xact_start","transform":"year_trunc","aggregate":null,"params":null,"transform_label":"Year","alias":"Check Out Date/Time","join":"","datatype":"timestamp","op":"=","op_label":"Equals","op_value":{}}},"aggfilter_tab":{}}},"order_by":[{"relation":"8df8113346fefc52aa9b43a53c7305b7","field":"name"},{"relation":"cb720e383a265d85a54487cf6e11277f","field":"name"},{"relation":"f45381a54504218e39aca33492d29306","field":"id"}],"8df8113346fefc52aa9b43a53c7305b7":{"label":"Circulation -> Workstation :: Owning Library","alias":"8df8113346fefc52aa9b43a53c7305b7","path":"circ-workstation.aws-owning_lib","join":"","reltype":"has_a","idlclass":"aou","table":"actor.org_unit","fields":{"dis_tab":{"name":{"colname":"name","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Workstation Library","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{"id":{"colname":"id","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Organizational Unit ID","join":"","datatype":"org_unit","op":"in","op_label":"In list","op_value":{}}},"aggfilter_tab":{}}},"cb720e383a265d85a54487cf6e11277f":{"label":"Circulation :: Workstation","alias":"cb720e383a265d85a54487cf6e11277f","path":"circ-workstation","join":"","reltype":"has_a","idlclass":"aws","table":"actor.workstation","fields":{"dis_tab":{"name":{"colname":"name","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Workstation Name","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{},"aggfilter_tab":{}}}}}', (select f.id from reporter.template_folder f JOIN reporter.template_folder ff on (f.parent = ff.id) where ff.name='EG Custom Reports' and f.name='Circulation Reports'));
INSERT INTO reporter.template ("owner", create_time, name, description, data, folder) VALUES (1, now(), 'Checkin Statistics', 'Checkin Stats -  This report shows check-in data by workstation location (library) and workstation name, filtered by date range (month) and workstation library. With specific dates as a filter, you may include previous month and same month previous year.', '{"version":3,"core_class":"circ","select":[{"alias":"Check In Date","column":{"colname":"checkin_time","transform":"month_trunc","transform_label":"Year + Month"},"path":"circ-checkin_time","relation":"f45381a54504218e39aca33492d29306"},{"alias":"Workstation Library","column":{"colname":"name","transform":"Bare","transform_label":"Raw Data"},"path":"circ-workstation-aws-owning_lib-aou-name","relation":"8df8113346fefc52aa9b43a53c7305b7"},{"alias":"Workstation Name","column":{"colname":"name","transform":"Bare","transform_label":"Raw Data"},"path":"circ-workstation-aws-name","relation":"cb720e383a265d85a54487cf6e11277f"},{"alias":"Circulation Count","column":{"colname":"id","transform":"count","transform_label":"Count"},"path":"circ-id","relation":"f45381a54504218e39aca33492d29306"}],"from":{"path":"circ-workstation","table":"action.circulation","label":"Circulation","alias":"f45381a54504218e39aca33492d29306","idlclass":"circ","template_path":"circ","join":{"workstation-f45381a54504218e39aca33492d29306":{"key":"id","path":"circ-workstation-aws-owning_lib","table":"actor.workstation","label":"Circulation :: Workstation","alias":"cb720e383a265d85a54487cf6e11277f","idlclass":"aws","template_path":"circ-workstation","join":{"owning_lib-cb720e383a265d85a54487cf6e11277f":{"key":"id","path":"circ-workstation-aws-owning_lib-aou","table":"actor.org_unit","label":"Circulation -> Workstation :: Owning Library","alias":"8df8113346fefc52aa9b43a53c7305b7","idlclass":"aou","template_path":"circ-workstation.aws-owning_lib"}}}}},"where":[{"alias":"Check In Date/Time","column":{"colname":"checkin_time","transform":"month_trunc","transform_label":"Year + Month"},"path":"circ-checkin_time","relation":"f45381a54504218e39aca33492d29306","condition":{"in":"::P0"}},{"alias":"Owning Library","column":{"colname":"owning_lib","transform":"Bare","transform_label":"Raw Data"},"path":"circ-workstation-aws-owning_lib","relation":"cb720e383a265d85a54487cf6e11277f","condition":{"in":"::P1"}}],"having":[],"order_by":[],"rel_cache":{"order_by":[{"relation":"f45381a54504218e39aca33492d29306","field":"checkin_time"},{"relation":"8df8113346fefc52aa9b43a53c7305b7","field":"name"},{"relation":"cb720e383a265d85a54487cf6e11277f","field":"name"},{"relation":"f45381a54504218e39aca33492d29306","field":"id"}],"f45381a54504218e39aca33492d29306":{"label":"Circulation","alias":"f45381a54504218e39aca33492d29306","path":"circ","join":"","reltype":"","idlclass":"circ","table":"action.circulation","fields":{"dis_tab":{"id":{"colname":"id","transform":"count","aggregate":true,"params":null,"transform_label":"Count","alias":"Circulation Count","join":"","datatype":"id","op":"=","op_label":"Equals","op_value":{}},"checkin_time":{"colname":"checkin_time","transform":"month_trunc","aggregate":null,"params":null,"transform_label":"Year + Month","alias":"Check In Date","join":"","datatype":"timestamp","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{"checkin_time":{"colname":"checkin_time","transform":"month_trunc","aggregate":null,"params":null,"transform_label":"Year + Month","alias":"Check In Date/Time","join":"","datatype":"timestamp","op":"in","op_label":"In list","op_value":{}}},"aggfilter_tab":{}}},"cb720e383a265d85a54487cf6e11277f":{"label":"Circulation :: Workstation","alias":"cb720e383a265d85a54487cf6e11277f","path":"circ-workstation","join":"","reltype":"has_a","idlclass":"aws","table":"actor.workstation","fields":{"dis_tab":{"name":{"colname":"name","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Workstation Name","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{"owning_lib":{"colname":"owning_lib","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Owning Library","join":"","datatype":"org_unit","op":"in","op_label":"In list","op_value":{}}},"aggfilter_tab":{}}},"8df8113346fefc52aa9b43a53c7305b7":{"label":"Circulation -> Workstation :: Owning Library","alias":"8df8113346fefc52aa9b43a53c7305b7","path":"circ-workstation.aws-owning_lib","join":"","reltype":"has_a","idlclass":"aou","table":"actor.org_unit","fields":{"dis_tab":{"name":{"colname":"name","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Workstation Library","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{},"aggfilter_tab":{}}}}}', (select f.id from reporter.template_folder f JOIN reporter.template_folder ff on (f.parent = ff.id) where ff.name='EG Custom Reports' and f.name='Circulation Reports'));
INSERT INTO reporter.template ("owner", create_time, name, description, data, folder) VALUES (1, now(), 'OPAC Renewal Statistics', 'OPAC Renewal Statistics - Shows # of Renewals that occurred via the web/OPAC filtered by date.', '{"version":3,"core_class":"circ","select":[{"alias":"Month","column":{"colname":"xact_start","transform":"month_trunc","transform_label":"Year + Month"},"path":"circ-xact_start","relation":"f45381a54504218e39aca33492d29306"},{"alias":"# of Renewals","column":{"colname":"id","transform":"count","transform_label":"Count"},"path":"circ-id","relation":"f45381a54504218e39aca33492d29306"}],"from":{"path":"circ","table":"action.circulation","label":"Circulation","alias":"f45381a54504218e39aca33492d29306","idlclass":"circ","template_path":"circ"},"where":[{"alias":"Check Out Date/Time","column":{"colname":"xact_start","transform":"month_trunc","transform_label":"Year + Month"},"path":"circ-xact_start","relation":"f45381a54504218e39aca33492d29306","condition":{"in":"::P0"}},{"alias":"OPAC Renewal","column":{"colname":"opac_renewal","transform":"Bare","transform_label":"Raw Data"},"path":"circ-opac_renewal","relation":"f45381a54504218e39aca33492d29306","condition":{"=":"t"}}],"having":[],"order_by":[],"rel_cache":{"order_by":[{"relation":"f45381a54504218e39aca33492d29306","field":"xact_start"},{"relation":"f45381a54504218e39aca33492d29306","field":"id"}],"f45381a54504218e39aca33492d29306":{"label":"Circulation","alias":"f45381a54504218e39aca33492d29306","path":"circ","join":"","reltype":"","idlclass":"circ","table":"action.circulation","fields":{"dis_tab":{"xact_start":{"colname":"xact_start","transform":"month_trunc","aggregate":null,"params":null,"transform_label":"Year + Month","alias":"Month","join":"","datatype":"timestamp","op":"=","op_label":"Equals","op_value":{}},"id":{"colname":"id","transform":"count","aggregate":true,"params":null,"transform_label":"Count","alias":"# of Renewals","join":"","datatype":"id","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{"xact_start":{"colname":"xact_start","transform":"month_trunc","aggregate":null,"params":null,"transform_label":"Year + Month","alias":"Check Out Date/Time","join":"","datatype":"timestamp","op":"in","op_label":"In list","op_value":{}},"opac_renewal":{"colname":"opac_renewal","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"OPAC Renewal","join":"","datatype":"bool","op":"=","op_label":"Equals","op_value":{"value":"t","label":"True"}}},"aggfilter_tab":{}}}}}', (select f.id from reporter.template_folder f JOIN reporter.template_folder ff on (f.parent = ff.id) where ff.name='EG Custom Reports' and f.name='Circulation Reports'));
INSERT INTO reporter.template ("owner", create_time, name, description, data, folder) VALUES (1, now(), 'Checkout Statistics by Circulation Type', 'A copy of Checkout Statistics but provides a breakdown of # of checkouts versus # of renewals.', '{"version":3,"core_class":"rcirct","select":[{"alias":"Month + Year","column":{"colname":"xact_start","transform":"month_trunc","transform_label":"Year + Month"},"path":"rcirct-id-circ-xact_start","relation":"fe0db6589df5caf37373ed1e6fa8b8f8"},{"alias":"Workstation Library","column":{"colname":"name","transform":"Bare","transform_label":"Raw Data"},"path":"rcirct-id-circ-workstation-aws-owning_lib-aou-name","relation":"43c8c0bf705e0729eb2ff3bb4b24cf6e"},{"alias":"Workstation Name","column":{"colname":"name","transform":"Bare","transform_label":"Raw Data"},"path":"rcirct-id-circ-workstation-aws-name","relation":"88bb9c57848fa18bef1748bb0b14d66d"},{"alias":"Circulation Type","column":{"colname":"type","transform":"Bare","transform_label":"Raw Data"},"path":"rcirct-type","relation":"20385bf22f46b56e0c2d64130fedf0e7"},{"alias":"Count","column":{"colname":"id","transform":"count_distinct","transform_label":"Count Distinct"},"path":"rcirct-id-circ-id","relation":"fe0db6589df5caf37373ed1e6fa8b8f8"}],"from":{"path":"rcirct-id","table":"reporter.circ_type","alias":"20385bf22f46b56e0c2d64130fedf0e7","join":{"id-circ-id-abe244f930e3701b14cd779105cf3525":{"key":"id","type":"left","path":"rcirct-id-circ-workstation","table":"action.circulation","label":"Circulation Type :: Circulation ID","alias":"fe0db6589df5caf37373ed1e6fa8b8f8","idlclass":"circ","template_path":"rcirct-id","join":{"workstation-fe0db6589df5caf37373ed1e6fa8b8f8":{"type":"left","key":"id","path":"rcirct-id-circ-workstation-aws","table":"actor.workstation","label":"Circulation Type -> Circulation :: Workstation","alias":"88bb9c57848fa18bef1748bb0b14d66d","idlclass":"aws","template_path":"rcirct-id.circ-workstation"}}},"id-circ-id-20385bf22f46b56e0c2d64130fedf0e7":{"key":"id","type":"left","path":"rcirct-id-circ-workstation","table":"action.circulation","alias":"47c4df5d1f0f613e6e156eff7c2ffb35","join":{"workstation-47c4df5d1f0f613e6e156eff7c2ffb35":{"type":"left","key":"id","path":"rcirct-id-circ-workstation-aws-owning_lib","table":"actor.workstation","alias":"d8d1a505a948af54052940f927c3c387","join":{"owning_lib-d8d1a505a948af54052940f927c3c387":{"type":"left","key":"id","path":"rcirct-id-circ-workstation-aws-owning_lib-aou","table":"actor.org_unit","label":"Circulation Type -> Circulation -> Workstation :: Owning Library","alias":"43c8c0bf705e0729eb2ff3bb4b24cf6e","idlclass":"aou","template_path":"rcirct-id.circ-workstation.aws-owning_lib"}}}}}},"label":"Circulation Type","idlclass":"rcirct","template_path":"rcirct"},"where":[{"alias":"Check Out Date/Time","column":{"colname":"xact_start","transform":"month_trunc","transform_label":"Year + Month"},"path":"rcirct-id-circ-xact_start","relation":"fe0db6589df5caf37373ed1e6fa8b8f8","condition":{"in":"::P0"}},{"alias":"Organizational Unit ID","column":{"colname":"id","transform":"Bare","transform_label":"Raw Data"},"path":"rcirct-id-circ-workstation-aws-owning_lib-aou-id","relation":"43c8c0bf705e0729eb2ff3bb4b24cf6e","condition":{"in":"::P1"}}],"having":[],"order_by":[],"rel_cache":{"fe0db6589df5caf37373ed1e6fa8b8f8":{"label":"Circulation Type :: Circulation ID","alias":"fe0db6589df5caf37373ed1e6fa8b8f8","path":"rcirct-id","join":"","reltype":"might_have","idlclass":"circ","table":"action.circulation","fields":{"dis_tab":{"id":{"colname":"id","transform":"count_distinct","aggregate":true,"params":null,"transform_label":"Count Distinct","alias":"Count","join":"","datatype":"id","op":"=","op_label":"Equals","op_value":{}},"xact_start":{"colname":"xact_start","transform":"month_trunc","aggregate":null,"params":null,"transform_label":"Year + Month","alias":"Month + Year","join":"","datatype":"timestamp","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{"xact_start":{"colname":"xact_start","transform":"month_trunc","aggregate":null,"params":null,"transform_label":"Year + Month","alias":"Check Out Date/Time","join":"","datatype":"timestamp","op":"in","op_label":"In list","op_value":{}}},"aggfilter_tab":{}}},"order_by":[{"relation":"fe0db6589df5caf37373ed1e6fa8b8f8","field":"xact_start"},{"relation":"43c8c0bf705e0729eb2ff3bb4b24cf6e","field":"name"},{"relation":"88bb9c57848fa18bef1748bb0b14d66d","field":"name"},{"relation":"20385bf22f46b56e0c2d64130fedf0e7","field":"type"},{"relation":"fe0db6589df5caf37373ed1e6fa8b8f8","field":"id"}],"88bb9c57848fa18bef1748bb0b14d66d":{"label":"Circulation Type -> Circulation :: Workstation","alias":"88bb9c57848fa18bef1748bb0b14d66d","path":"rcirct-id.circ-workstation","join":"","reltype":"has_a","idlclass":"aws","table":"actor.workstation","fields":{"dis_tab":{"name":{"colname":"name","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Workstation Name","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{},"aggfilter_tab":{}}},"20385bf22f46b56e0c2d64130fedf0e7":{"label":"Circulation Type","alias":"20385bf22f46b56e0c2d64130fedf0e7","path":"rcirct","join":"","reltype":"","idlclass":"rcirct","table":"reporter.circ_type","fields":{"dis_tab":{"type":{"colname":"type","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Circulation Type","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{},"aggfilter_tab":{}}},"43c8c0bf705e0729eb2ff3bb4b24cf6e":{"label":"Circulation Type -> Circulation -> Workstation :: Owning Library","alias":"43c8c0bf705e0729eb2ff3bb4b24cf6e","path":"rcirct-id.circ-workstation.aws-owning_lib","join":"","reltype":"has_a","idlclass":"aou","table":"actor.org_unit","fields":{"dis_tab":{"name":{"colname":"name","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Workstation Library","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{"id":{"colname":"id","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Organizational Unit ID","join":"","datatype":"org_unit","op":"in","op_label":"In list","op_value":{}}},"aggfilter_tab":{}}}}}', (select f.id from reporter.template_folder f JOIN reporter.template_folder ff on (f.parent = ff.id) where ff.name='EG Custom Reports' and f.name='Circulation Reports'));
INSERT INTO reporter.template ("owner", create_time, name, description, data, folder) VALUES (1, now(), 'Checkout Statistics', 'Checkout Stats -  This report shows checkout data by workstation location (library) and workstation name, filtered by date range (month) and workstation library. With specific dates as a filter, you may include previous month and same month previous year.', '{"version":3,"core_class":"circ","select":[{"alias":"Month","column":{"colname":"xact_start","transform":"month_trunc","transform_label":"Year + Month"},"path":"circ-xact_start","relation":"f45381a54504218e39aca33492d29306"},{"alias":"Workstation Library","column":{"colname":"name","transform":"Bare","transform_label":"Raw Data"},"path":"circ-workstation-aws-owning_lib-aou-name","relation":"8df8113346fefc52aa9b43a53c7305b7"},{"alias":"Workstation Name","column":{"colname":"name","transform":"Bare","transform_label":"Raw Data"},"path":"circ-workstation-aws-name","relation":"cb720e383a265d85a54487cf6e11277f"},{"alias":"Circulation Count","column":{"colname":"id","transform":"count","transform_label":"Count"},"path":"circ-id","relation":"f45381a54504218e39aca33492d29306"}],"from":{"path":"circ-workstation","table":"action.circulation","label":"Circulation","alias":"f45381a54504218e39aca33492d29306","idlclass":"circ","template_path":"circ","join":{"workstation-f45381a54504218e39aca33492d29306":{"key":"id","path":"circ-workstation-aws-owning_lib","table":"actor.workstation","label":"Circulation :: Workstation","alias":"cb720e383a265d85a54487cf6e11277f","idlclass":"aws","template_path":"circ-workstation","join":{"owning_lib-cb720e383a265d85a54487cf6e11277f":{"key":"id","path":"circ-workstation-aws-owning_lib-aou","table":"actor.org_unit","label":"Circulation -> Workstation :: Owning Library","alias":"8df8113346fefc52aa9b43a53c7305b7","idlclass":"aou","template_path":"circ-workstation.aws-owning_lib"}}}}},"where":[{"alias":"Check Out Date/Time","column":{"colname":"xact_start","transform":"month_trunc","transform_label":"Year + Month"},"path":"circ-xact_start","relation":"f45381a54504218e39aca33492d29306","condition":{"in":"::P0"}},{"alias":"Owning Library","column":{"colname":"owning_lib","transform":"Bare","transform_label":"Raw Data"},"path":"circ-workstation-aws-owning_lib","relation":"cb720e383a265d85a54487cf6e11277f","condition":{"in":"::P1"}}],"having":[],"order_by":[],"rel_cache":{"order_by":[{"relation":"f45381a54504218e39aca33492d29306","field":"xact_start"},{"relation":"8df8113346fefc52aa9b43a53c7305b7","field":"name"},{"relation":"cb720e383a265d85a54487cf6e11277f","field":"name"},{"relation":"f45381a54504218e39aca33492d29306","field":"id"}],"f45381a54504218e39aca33492d29306":{"label":"Circulation","alias":"f45381a54504218e39aca33492d29306","path":"circ","join":"","reltype":"","idlclass":"circ","table":"action.circulation","fields":{"dis_tab":{"xact_start":{"colname":"xact_start","transform":"month_trunc","aggregate":null,"params":null,"transform_label":"Year + Month","alias":"Month","join":"","datatype":"timestamp","op":"=","op_label":"Equals","op_value":{}},"id":{"colname":"id","transform":"count","aggregate":true,"params":null,"transform_label":"Count","alias":"Circulation Count","join":"","datatype":"id","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{"xact_start":{"colname":"xact_start","transform":"month_trunc","aggregate":null,"params":null,"transform_label":"Year + Month","alias":"Check Out Date/Time","join":"","datatype":"timestamp","op":"in","op_label":"In list","op_value":{}}},"aggfilter_tab":{}}},"cb720e383a265d85a54487cf6e11277f":{"label":"Circulation :: Workstation","alias":"cb720e383a265d85a54487cf6e11277f","path":"circ-workstation","join":"","reltype":"has_a","idlclass":"aws","table":"actor.workstation","fields":{"dis_tab":{"name":{"colname":"name","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Workstation Name","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{"owning_lib":{"colname":"owning_lib","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Owning Library","join":"","datatype":"org_unit","op":"in","op_label":"In list","op_value":{}}},"aggfilter_tab":{}}},"8df8113346fefc52aa9b43a53c7305b7":{"label":"Circulation -> Workstation :: Owning Library","alias":"8df8113346fefc52aa9b43a53c7305b7","path":"circ-workstation.aws-owning_lib","join":"","reltype":"has_a","idlclass":"aou","table":"actor.org_unit","fields":{"dis_tab":{"name":{"colname":"name","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Workstation Library","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{},"aggfilter_tab":{}}}}}', (select f.id from reporter.template_folder f JOIN reporter.template_folder ff on (f.parent = ff.id) where ff.name='EG Custom Reports' and f.name='Circulation Reports'));
INSERT INTO reporter.template ("owner", create_time, name, description, data, folder) VALUES (1, now(), 'Holds Filled Report (by Fulfillment Date & Pickup Library)', 'Displays fulfillment date and pickup library + total count. Filters on fulfillment date and pickup library.', '{"version":3,"core_class":"ahr","select":[{"alias":"Fulfillment Date","column":{"colname":"fulfillment_time","transform":"month_trunc","transform_label":"Year + Month"},"path":"ahr-fulfillment_time","relation":"3b0d7d05c65006de7b2ca20f5fe39690"},{"alias":"Pickup Library","column":{"colname":"name","transform":"Bare","transform_label":"Raw Data"},"path":"ahr-pickup_lib-aou-name","relation":"4f6ab23c031294937877e3e686649b0e"},{"alias":"Hold Count","column":{"colname":"id","transform":"count","transform_label":"Count"},"path":"ahr-id","relation":"3b0d7d05c65006de7b2ca20f5fe39690"}],"from":{"path":"ahr-pickup_lib","table":"action.hold_request","label":"Hold Request","alias":"3b0d7d05c65006de7b2ca20f5fe39690","idlclass":"ahr","template_path":"ahr","join":{"pickup_lib-3b0d7d05c65006de7b2ca20f5fe39690":{"key":"id","path":"ahr-pickup_lib-aou","table":"actor.org_unit","label":"Hold Request :: Pickup Library","alias":"4f6ab23c031294937877e3e686649b0e","idlclass":"aou","template_path":"ahr-pickup_lib"}}},"where":[{"alias":"Fulfillment Date/Time","column":{"colname":"fulfillment_time","transform":"date","transform_label":"Date"},"path":"ahr-fulfillment_time","relation":"3b0d7d05c65006de7b2ca20f5fe39690","condition":{"between":"::P0"}},{"alias":"Pickup Library","column":{"colname":"pickup_lib","transform":"Bare","transform_label":"Raw Data"},"path":"ahr-pickup_lib","relation":"3b0d7d05c65006de7b2ca20f5fe39690","condition":{"in":"::P1"}}],"having":[],"order_by":[],"rel_cache":{"3b0d7d05c65006de7b2ca20f5fe39690":{"label":"Hold Request","alias":"3b0d7d05c65006de7b2ca20f5fe39690","path":"ahr","join":"","reltype":"","idlclass":"ahr","table":"action.hold_request","fields":{"dis_tab":{"id":{"colname":"id","transform":"count","aggregate":true,"params":null,"transform_label":"Count","alias":"Hold Count","join":"","datatype":"id","op":"=","op_label":"Equals","op_value":{}},"fulfillment_time":{"colname":"fulfillment_time","transform":"month_trunc","aggregate":null,"params":null,"transform_label":"Year + Month","alias":"Fulfillment Date","join":"","datatype":"timestamp","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{"fulfillment_time":{"colname":"fulfillment_time","transform":"date","aggregate":null,"params":null,"transform_label":"Date","alias":"Fulfillment Date/Time","join":"","datatype":"timestamp","op":"between","op_label":"Between","op_value":{}},"pickup_lib":{"colname":"pickup_lib","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Pickup Library","join":"","datatype":"org_unit","op":"in","op_label":"In list","op_value":{}}},"aggfilter_tab":{}}},"order_by":[{"relation":"3b0d7d05c65006de7b2ca20f5fe39690","field":"fulfillment_time"},{"relation":"4f6ab23c031294937877e3e686649b0e","field":"name"},{"relation":"3b0d7d05c65006de7b2ca20f5fe39690","field":"id"}],"4f6ab23c031294937877e3e686649b0e":{"label":"Hold Request :: Pickup Library","alias":"4f6ab23c031294937877e3e686649b0e","path":"ahr-pickup_lib","join":"","reltype":"has_a","idlclass":"aou","table":"actor.org_unit","fields":{"dis_tab":{"name":{"colname":"name","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Pickup Library","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{},"aggfilter_tab":{}}}}}', (select f.id from reporter.template_folder f JOIN reporter.template_folder ff on (f.parent = ff.id) where ff.name='EG Custom Reports' and f.name='Circulation Reports'));
INSERT INTO reporter.template ("owner", create_time, name, description, data, folder) VALUES (1, now(), 'Circulation Statistics by Patron Address', 'Displays workstation library, patron address info and circulation total (distinct count by address). Filtered by checkout date range and workstation library list.', '{"version":3,"core_class":"circ","select":[{"alias":"Workstation Library","column":{"colname":"name","transform":"Bare","transform_label":"Raw Data"},"path":"circ-workstation-aws-owning_lib-aou-name","relation":"8df8113346fefc52aa9b43a53c7305b7"},{"alias":"Street (1)","column":{"colname":"street1","transform":"Bare","transform_label":"Raw Data"},"path":"circ-usr-au-addresses-aua-street1","relation":"ec0955df9c527486ffa86bcf35b87cf7"},{"alias":"Street (2)","column":{"colname":"street2","transform":"Bare","transform_label":"Raw Data"},"path":"circ-usr-au-addresses-aua-street2","relation":"ec0955df9c527486ffa86bcf35b87cf7"},{"alias":"City","column":{"colname":"city","transform":"Bare","transform_label":"Raw Data"},"path":"circ-usr-au-addresses-aua-city","relation":"ec0955df9c527486ffa86bcf35b87cf7"},{"alias":"State","column":{"colname":"state","transform":"Bare","transform_label":"Raw Data"},"path":"circ-usr-au-addresses-aua-state","relation":"ec0955df9c527486ffa86bcf35b87cf7"},{"alias":"Postal Code","column":{"colname":"post_code","transform":"Bare","transform_label":"Raw Data"},"path":"circ-usr-au-addresses-aua-post_code","relation":"ec0955df9c527486ffa86bcf35b87cf7"},{"alias":"Circ Total","column":{"colname":"id","transform":"count_distinct","transform_label":"Count Distinct"},"path":"circ-id","relation":"f45381a54504218e39aca33492d29306"}],"from":{"path":"circ-workstation","table":"action.circulation","label":"Circulation","alias":"f45381a54504218e39aca33492d29306","idlclass":"circ","template_path":"circ","join":{"usr-f45381a54504218e39aca33492d29306":{"key":"id","type":"left","path":"circ-usr-au-addresses","table":"actor.usr","alias":"51ff21595546b441243df33b41e6108a","join":{"id-aua-usr-51ff21595546b441243df33b41e6108a":{"type":"left","key":"usr","path":"circ-usr-au-addresses-aua","table":"actor.usr_address","label":"Circulation -> ILS User :: All Addresses","alias":"ec0955df9c527486ffa86bcf35b87cf7","idlclass":"aua","template_path":"circ-usr.au-addresses"}}},"workstation-f45381a54504218e39aca33492d29306":{"key":"id","path":"circ-workstation-aws","table":"actor.workstation","alias":"cb720e383a265d85a54487cf6e11277f","join":{"owning_lib-05073cb8dd74bd0c237763b7b4739286":{"key":"id","path":"circ-workstation-aws-owning_lib-aou","table":"actor.org_unit","label":"Circulation -> Workstation :: Owning Library","alias":"8df8113346fefc52aa9b43a53c7305b7","idlclass":"aou","template_path":"circ-workstation.aws-owning_lib"}},"label":"Circulation :: Workstation","idlclass":"aws","template_path":"circ-workstation"}}},"where":[{"alias":"Check Out Date/Time","column":{"colname":"xact_start","transform":"date","transform_label":"Date"},"path":"circ-xact_start","relation":"f45381a54504218e39aca33492d29306","condition":{"between":"::P0"}},{"alias":"Owning Library","column":{"colname":"owning_lib","transform":"Bare","transform_label":"Raw Data"},"path":"circ-workstation-aws-owning_lib","relation":"cb720e383a265d85a54487cf6e11277f","condition":{"in":"::P1"}}],"having":[],"order_by":[],"rel_cache":{"f45381a54504218e39aca33492d29306":{"label":"Circulation","alias":"f45381a54504218e39aca33492d29306","path":"circ","join":"","reltype":"","idlclass":"circ","table":"action.circulation","fields":{"dis_tab":{"id":{"colname":"id","transform":"count_distinct","aggregate":true,"params":null,"transform_label":"Count Distinct","alias":"Circ Total","join":"","datatype":"id","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{"xact_start":{"colname":"xact_start","transform":"date","aggregate":null,"params":null,"transform_label":"Date","alias":"Check Out Date/Time","join":"","datatype":"timestamp","op":"between","op_label":"Between","op_value":{}}},"aggfilter_tab":{}}},"order_by":[{"relation":"8df8113346fefc52aa9b43a53c7305b7","field":"name"},{"relation":"ec0955df9c527486ffa86bcf35b87cf7","field":"street1"},{"relation":"ec0955df9c527486ffa86bcf35b87cf7","field":"street2"},{"relation":"ec0955df9c527486ffa86bcf35b87cf7","field":"city"},{"relation":"ec0955df9c527486ffa86bcf35b87cf7","field":"state"},{"relation":"ec0955df9c527486ffa86bcf35b87cf7","field":"post_code"},{"relation":"f45381a54504218e39aca33492d29306","field":"id"}],"ec0955df9c527486ffa86bcf35b87cf7":{"label":"Circulation -> ILS User :: All Addresses","alias":"ec0955df9c527486ffa86bcf35b87cf7","path":"circ-usr.au-addresses","join":"","reltype":"has_many","idlclass":"aua","table":"actor.usr_address","fields":{"dis_tab":{"street1":{"colname":"street1","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Street (1)","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}},"street2":{"colname":"street2","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Street (2)","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}},"city":{"colname":"city","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"City","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}},"state":{"colname":"state","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"State","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}},"post_code":{"colname":"post_code","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Postal Code","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{},"aggfilter_tab":{}}},"8df8113346fefc52aa9b43a53c7305b7":{"label":"Circulation -> Workstation :: Owning Library","alias":"8df8113346fefc52aa9b43a53c7305b7","path":"circ-workstation.aws-owning_lib","join":"","reltype":"has_a","idlclass":"aou","table":"actor.org_unit","fields":{"dis_tab":{"name":{"colname":"name","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Workstation Library","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{},"aggfilter_tab":{}}},"cb720e383a265d85a54487cf6e11277f":{"label":"Circulation :: Workstation","alias":"cb720e383a265d85a54487cf6e11277f","path":"circ-workstation","join":"","reltype":"has_a","idlclass":"aws","table":"actor.workstation","fields":{"dis_tab":{},"filter_tab":{"owning_lib":{"colname":"owning_lib","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Owning Library","join":"","datatype":"org_unit","op":"in","op_label":"In list","op_value":{}}},"aggfilter_tab":{}}}}}', (select f.id from reporter.template_folder f JOIN reporter.template_folder ff on (f.parent = ff.id) where ff.name='EG Custom Reports' and f.name='Circulation Reports'));
INSERT INTO reporter.template ("owner", create_time, name, description, data, folder) VALUES (1, now(), 'Placed Holds by Patron Group and Requesting Library', 'Circulation (Placed Holds) Report - This report shows the placed holds, grouped by requesting library and date range (month) for request date. Additional filter to run this report just for specific patron groups (staff versus patron placed holds).', '{"version":3,"core_class":"ahr","select":[{"alias":"Request Date","column":{"colname":"request_time","transform":"month_trunc","transform_label":"Year + Month"},"path":"ahr-request_time","relation":"3b0d7d05c65006de7b2ca20f5fe39690"},{"alias":"Requesting Library","column":{"colname":"name","transform":"Bare","transform_label":"Raw Data"},"path":"ahr-request_lib-aou-name","relation":"92cf395b3894665b6ddf29a2ce29c567"},{"alias":"# of Holds Placed","column":{"colname":"id","transform":"count","transform_label":"Count"},"path":"ahr-id","relation":"3b0d7d05c65006de7b2ca20f5fe39690"}],"from":{"path":"ahr-request_lib","table":"action.hold_request","label":"Hold Request","alias":"3b0d7d05c65006de7b2ca20f5fe39690","idlclass":"ahr","template_path":"ahr","join":{"requestor-3b0d7d05c65006de7b2ca20f5fe39690":{"key":"id","path":"ahr-requestor-au-profile","table":"actor.usr","alias":"7b5f37f34aa9c4e1749c40a45f91f782","join":{"profile-7b5f37f34aa9c4e1749c40a45f91f782":{"key":"id","path":"ahr-requestor-au-profile-pgt","table":"permission.grp_tree","label":"Hold Request -> ILS User :: Main (Profile) Permission Group","alias":"6a64bed13e7e06b3e51301a9e70e39ec","idlclass":"pgt","template_path":"ahr-requestor.au-profile"}}},"request_lib-3b0d7d05c65006de7b2ca20f5fe39690":{"key":"id","path":"ahr-request_lib-aou","table":"actor.org_unit","label":"Hold Request :: Requesting Library","alias":"92cf395b3894665b6ddf29a2ce29c567","idlclass":"aou","template_path":"ahr-request_lib"}}},"where":[{"alias":"Request Date/Time","column":{"colname":"request_time","transform":"month_trunc","transform_label":"Year + Month"},"path":"ahr-request_time","relation":"3b0d7d05c65006de7b2ca20f5fe39690","condition":{"in":"::P0"}},{"alias":"Group ID","column":{"colname":"id","transform":"Bare","transform_label":"Raw Data"},"path":"ahr-requestor-au-profile-pgt-id","relation":"6a64bed13e7e06b3e51301a9e70e39ec","condition":{"in":"::P1"}}],"having":[],"order_by":[],"rel_cache":{"3b0d7d05c65006de7b2ca20f5fe39690":{"label":"Hold Request","alias":"3b0d7d05c65006de7b2ca20f5fe39690","path":"ahr","join":"","reltype":"","idlclass":"ahr","table":"action.hold_request","fields":{"dis_tab":{"id":{"colname":"id","transform":"count","aggregate":true,"params":null,"transform_label":"Count","alias":"# of Holds Placed","join":"","datatype":"id","op":"=","op_label":"Equals","op_value":{}},"request_time":{"colname":"request_time","transform":"month_trunc","aggregate":null,"params":null,"transform_label":"Year + Month","alias":"Request Date","join":"","datatype":"timestamp","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{"request_time":{"colname":"request_time","transform":"month_trunc","aggregate":null,"params":null,"transform_label":"Year + Month","alias":"Request Date/Time","join":"","datatype":"timestamp","op":"in","op_label":"In list","op_value":{}}},"aggfilter_tab":{}}},"order_by":[{"relation":"3b0d7d05c65006de7b2ca20f5fe39690","field":"request_time"},{"relation":"92cf395b3894665b6ddf29a2ce29c567","field":"name"},{"relation":"3b0d7d05c65006de7b2ca20f5fe39690","field":"id"}],"6a64bed13e7e06b3e51301a9e70e39ec":{"label":"Hold Request -> ILS User :: Main (Profile) Permission Group","alias":"6a64bed13e7e06b3e51301a9e70e39ec","path":"ahr-requestor.au-profile","join":"","reltype":"has_a","idlclass":"pgt","table":"permission.grp_tree","fields":{"dis_tab":{},"filter_tab":{"id":{"colname":"id","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Group ID","join":"","datatype":"id","op":"in","op_label":"In list","op_value":{}}},"aggfilter_tab":{}}},"92cf395b3894665b6ddf29a2ce29c567":{"label":"Hold Request :: Requesting Library","alias":"92cf395b3894665b6ddf29a2ce29c567","path":"ahr-request_lib","join":"","reltype":"has_a","idlclass":"aou","table":"actor.org_unit","fields":{"dis_tab":{"name":{"colname":"name","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Requesting Library","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{},"aggfilter_tab":{}}}}}', (select f.id from reporter.template_folder f JOIN reporter.template_folder ff on (f.parent = ff.id) where ff.name='EG Custom Reports' and f.name='Circulation Reports'));

INSERT INTO reporter.template ("owner", create_time, name, description, data, folder) VALUES (1, now(), 'Purchase Alerts Report', 'Includes title, author, publisher, publication year, language, call number and isbn for each title on hold. Included in display are also the holdable copies, active holds and hold/copy ratio counts. Filtered by hold/copy ratio and call number range.', '{"version":3,"core_class":"rhcrpb","select":[{"alias":"Lang","column":{"colname":"item_lang","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-id-bre-call_numbers-acn-record-bre-fixed_fields-mrd-item_lang","relation":"a80af59b2a26ae26095dfb0239dccc21"},{"alias":"Call Number Label","column":{"colname":"label","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-id-bre-call_numbers-acn-label","relation":"55fb42231a310eb83c192b8a99d74bdb"},{"alias":"Record ID","column":{"colname":"id","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-id","relation":"210446682bb49afb05aad68eb78b4d4a"},{"alias":"Author","column":{"colname":"author","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-id-bre-simple_record-rmsr-author","relation":"da9f0cb56ef4349e224632f85fbf25f8"},{"alias":"Title","column":{"colname":"title","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-id-bre-simple_record-rmsr-title","relation":"da9f0cb56ef4349e224632f85fbf25f8"},{"alias":"ISBN","column":{"colname":"isbn","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-id-bre-simple_record-rmsr-isbn","relation":"da9f0cb56ef4349e224632f85fbf25f8"},{"alias":"Publisher","column":{"colname":"publisher","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-id-bre-simple_record-rmsr-publisher","relation":"da9f0cb56ef4349e224632f85fbf25f8"},{"alias":"Publication Year","column":{"colname":"pubdate","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-id-bre-simple_record-rmsr-pubdate","relation":"da9f0cb56ef4349e224632f85fbf25f8"},{"alias":"Price","column":{"colname":"price","transform":"max","transform_label":"Max"},"path":"rhcrpb-id-bre-call_numbers-acn-copies-acp-price","relation":"47b392060f03746d1697749dbb31b328"},{"alias":"Holdable Copy Count","column":{"colname":"copy_count","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-copy_count","relation":"210446682bb49afb05aad68eb78b4d4a"},{"alias":"Active Holds","column":{"colname":"hold_count","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-hold_count","relation":"210446682bb49afb05aad68eb78b4d4a"},{"alias":"Hold/Copy Ratio","column":{"colname":"hold_copy_ratio","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-hold_copy_ratio","relation":"210446682bb49afb05aad68eb78b4d4a"}],"from":{"path":"rhcrpb-id","table":"(\\n\\n            -- -- If we uncomment the RIGHT JOIN against biblio.record_entry, then well get a row for every non-deleted bib, whether it has active holds or not.\\n            -- -- If we expect to use pcrud to query against specific bibs, we probably want to do this.  However, if were using this to populate a report, we\\n            -- -- may not.\\n            -- SELECT\\n            --     bre.id AS "bib_id",\\n            --     COALESCE( z.copy_count, 0 ) AS "copy_count",\\n            --     COALESCE( z.hold_count, 0 ) AS "hold_count",\\n            --     COALESCE( z.copy_hold_ratio, 0 ) AS "hold_copy_ratio"\\n            -- FROM (\\n                SELECT\\n                    y.bre AS "id",\\n                    COALESCE( x.copy_count, 0 ) AS "copy_count",\\n                    y.hold_count AS "hold_count",\\n                    (y.hold_count::REAL / (CASE WHEN x.copy_count = 0 OR x.copy_count IS NULL THEN 0.1 ELSE x.copy_count::REAL END)) AS "hold_copy_ratio"\\n                FROM (\\n                        SELECT\\n                            (SELECT bib_record FROM reporter.hold_request_record r WHERE r.id = h.id LIMIT 1) AS "bre",\\n                            COUNT(*) AS "hold_count"\\n                        FROM action.hold_request h\\n                        WHERE\\n                            cancel_time IS NULL\\n                            AND fulfillment_time IS NULL\\n                            -- AND NOT frozen  -- a frozen hold is still a desired hold, eh?\\n                        GROUP BY 1\\n                    )y LEFT JOIN (\\n                        SELECT \\n                            (SELECT id\\n                                FROM biblio.record_entry \\n                                WHERE id = (SELECT record FROM asset.call_number WHERE id = call_number)\\n                            ) AS "bre", \\n                            COUNT(*) AS "copy_count"\\n                        FROM asset.copy\\n                            JOIN asset.copy_location loc ON (copy.location = loc.id AND loc.holdable)\\n                        WHERE copy.holdable \\n                            AND NOT copy.deleted \\n                            AND copy.status IN ( SELECT id FROM config.copy_status WHERE holdable ) \\n                        GROUP BY 1\\n                    )x ON x.bre = y.bre\\n                -- )z RIGHT JOIN (\\n                --     SELECT id\\n                --     FROM biblio.record_entry\\n                --     WHERE NOT deleted\\n                -- )bre ON (z.bib_id = bre.id)\\n                \\n\\n\\t\\t)","label":"Hold/Copy Ratio per Bib","alias":"210446682bb49afb05aad68eb78b4d4a","idlclass":"rhcrpb","template_path":"rhcrpb","join":{"id-210446682bb49afb05aad68eb78b4d4a":{"key":"id","type":"left","path":"rhcrpb-id-bre-call_numbers","table":"biblio.record_entry","alias":"c2b38d181ecc7e6f29dc9aa17e4b1550","join":{"id-rmsr-id-c2b38d181ecc7e6f29dc9aa17e4b1550":{"type":"left","key":"id","path":"rhcrpb-id-bre-simple_record-rmsr","table":"reporter.materialized_simple_record","label":"Hold/Copy Ratio per Bib -> Bibliographic Record :: Simple Record Extracts ","alias":"da9f0cb56ef4349e224632f85fbf25f8","idlclass":"rmsr","template_path":"rhcrpb-id.bre-simple_record"},"id-acn-record-c2b38d181ecc7e6f29dc9aa17e4b1550":{"type":"left","key":"record","path":"rhcrpb-id-bre-call_numbers-acn-record","table":"asset.call_number","label":"Hold/Copy Ratio per Bib -> Bibliographic Record :: Call Numbers","alias":"55fb42231a310eb83c192b8a99d74bdb","idlclass":"acn","template_path":"rhcrpb-id.bre-call_numbers","join":{"id-acp-call_number-55fb42231a310eb83c192b8a99d74bdb":{"type":"left","key":"call_number","path":"rhcrpb-id-bre-call_numbers-acn-copies-acp","table":"asset.copy","label":"Hold/Copy Ratio per Bib -> Bibliographic Record -> Call Number/Volume :: Copies","alias":"47b392060f03746d1697749dbb31b328","idlclass":"acp","template_path":"rhcrpb-id.bre-call_numbers.acn-copies"},"record-55fb42231a310eb83c192b8a99d74bdb":{"type":"left","key":"id","path":"rhcrpb-id-bre-call_numbers-acn-record-bre-fixed_fields","table":"biblio.record_entry","alias":"cb6ace8c7a3586c69a35a94ce8dadadf","join":{"id-mrd-record-cb6ace8c7a3586c69a35a94ce8dadadf":{"type":"left","key":"record","path":"rhcrpb-id-bre-call_numbers-acn-record-bre-fixed_fields-mrd","table":"metabib.rec_descriptor","label":"Hold/Copy Ratio per Bib -> Bibliographic Record -> Call Number/Volume -> Bibliographic Record :: Fixed Field Entry","alias":"a80af59b2a26ae26095dfb0239dccc21","idlclass":"mrd","template_path":"rhcrpb-id.bre-call_numbers.acn-record.bre-fixed_fields"}}}}}}}}},"where":[{"alias":"Hold/Copy Ratio","column":{"colname":"hold_copy_ratio","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-hold_copy_ratio","relation":"210446682bb49afb05aad68eb78b4d4a","condition":{">=":"::P0"}},{"alias":"Call Number Label","column":{"colname":"label","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-id-bre-call_numbers-acn-label","relation":"55fb42231a310eb83c192b8a99d74bdb","condition":{"between":"::P1"}}],"having":[],"order_by":[],"rel_cache":{"210446682bb49afb05aad68eb78b4d4a":{"label":"Hold/Copy Ratio per Bib","alias":"210446682bb49afb05aad68eb78b4d4a","path":"rhcrpb","join":"","reltype":"","idlclass":"rhcrpb","table":"(\\n\\n            -- -- If we uncomment the RIGHT JOIN against biblio.record_entry, then well get a row for every non-deleted bib, whether it has active holds or not.\\n            -- -- If we expect to use pcrud to query against specific bibs, we probably want to do this.  However, if were using this to populate a report, we\\n            -- -- may not.\\n            -- SELECT\\n--     bre.id AS "bib_id",\\n            --     COALESCE( z.copy_count, 0 ) AS "copy_count",\\n            --     COALESCE( z.hold_count, 0 ) AS "hold_count",\\n            --     COALESCE( z.copy_hold_ratio, 0 ) AS "hold_copy_ratio"\\n            -- FROM (\\n                SELECT\\n                    y.bre AS "id",\\n                    COALESCE( x.copy_count, 0 ) AS "copy_count",\\n                    y.hold_count AS "hold_count",\\n                    (y.hold_count::REAL / (CASE WHEN x.copy_count = 0 OR x.copy_count IS NULL THEN 0.1 ELSE x.copy_count::REAL END)) AS "hold_copy_ratio"\\n                FROM (\\n                        SELECT\\n                            (SELECT bib_record FROM reporter.hold_request_record r WHERE r.id = h.id LIMIT 1) AS "bre",\\n                            COUNT(*) AS "hold_count"\\n                        FROM action.hold_request h\\n                        WHERE\\n                            cancel_time IS NULL\\n                            AND fulfillment_time IS NULL\\n                            -- AND NOT frozen  -- a frozen hold is still a desired hold, eh?\\n                        GROUP BY 1\\n                    )y LEFT JOIN (\\n                        SELECT \\n                            (SELECT id\\n                                FROM biblio.record_entry \\n                                WHERE id = (SELECT record FROM asset.call_number WHERE id = call_number)\\n                            ) AS "bre", \\n                            COUNT(*) AS "copy_count"\\n                        FROM asset.copy\\n                            JOIN asset.copy_location loc ON (copy.location = loc.id AND loc.holdable)\\n                        WHERE copy.holdable \\n                            AND NOT copy.deleted \\n                            AND copy.status IN ( SELECT id FROM config.copy_status WHERE holdable ) \\n                        GROUP BY 1\\n                    )x ON x.bre = y.bre\\n                -- )z RIGHT JOIN (\\n                --     SELECT id\\n                --     FROM biblio.record_entry\\n                --     WHERE NOT deleted\\n                -- )bre ON (z.bib_id = bre.id)\\n                \\n\\n\\t\\t)","fields":{"dis_tab":{"copy_count":{"colname":"copy_count","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Holdable Copy Count","join":"","datatype":"int","op":"=","op_label":"Equals","op_value":{}},"hold_copy_ratio":{"colname":"hold_copy_ratio","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Hold/Copy Ratio","join":"","datatype":"float","op":"=","op_label":"Equals","op_value":{}},"id":{"colname":"id","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Record ID","join":"","datatype":"id","op":"=","op_label":"Equals","op_value":{}},"hold_count":{"colname":"hold_count","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Active Holds","join":"","datatype":"int","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{"hold_copy_ratio":{"colname":"hold_copy_ratio","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Hold/Copy Ratio","join":"","datatype":"float","op":">=","op_label":"Greater than or equal to","op_value":{}}},"aggfilter_tab":{}}},"order_by":[{"relation":"a80af59b2a26ae26095dfb0239dccc21","field":"item_lang"},{"relation":"55fb42231a310eb83c192b8a99d74bdb","field":"label"},{"relation":"210446682bb49afb05aad68eb78b4d4a","field":"id"},{"relation":"da9f0cb56ef4349e224632f85fbf25f8","field":"author"},{"relation":"da9f0cb56ef4349e224632f85fbf25f8","field":"title"},{"relation":"da9f0cb56ef4349e224632f85fbf25f8","field":"isbn"},{"relation":"da9f0cb56ef4349e224632f85fbf25f8","field":"publisher"},{"relation":"da9f0cb56ef4349e224632f85fbf25f8","field":"pubdate"},{"relation":"47b392060f03746d1697749dbb31b328","field":"price"},{"relation":"210446682bb49afb05aad68eb78b4d4a","field":"copy_count"},{"relation":"210446682bb49afb05aad68eb78b4d4a","field":"hold_count"},{"relation":"210446682bb49afb05aad68eb78b4d4a","field":"hold_copy_ratio"}],"da9f0cb56ef4349e224632f85fbf25f8":{"label":"Hold/Copy Ratio per Bib -> Bibliographic Record :: Simple Record Extracts ","alias":"da9f0cb56ef4349e224632f85fbf25f8","path":"rhcrpb-id.bre-simple_record","join":"","reltype":"might_have","idlclass":"rmsr","table":"reporter.materialized_simple_record","fields":{"dis_tab":{"author":{"colname":"author","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Author","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}},"pubdate":{"colname":"pubdate","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Publication Year","join":"","datatype":"int","op":"=","op_label":"Equals","op_value":{}},"publisher":{"colname":"publisher","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Publisher","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}},"title":{"colname":"title","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Title","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}},"isbn":{"colname":"isbn","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"ISBN","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{},"aggfilter_tab":{}}},"55fb42231a310eb83c192b8a99d74bdb":{"label":"Hold/Copy Ratio per Bib -> Bibliographic Record :: Call Numbers","alias":"55fb42231a310eb83c192b8a99d74bdb","path":"rhcrpb-id.bre-call_numbers","join":"","reltype":"has_many","idlclass":"acn","table":"asset.call_number","fields":{"dis_tab":{"label":{"colname":"label","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Call Number Label","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{"label":{"colname":"label","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Call Number Label","join":"","datatype":"text","op":"between","op_label":"Between","op_value":{}}},"aggfilter_tab":{}}},"47b392060f03746d1697749dbb31b328":{"label":"Hold/Copy Ratio per Bib -> Bibliographic Record -> Call Number/Volume :: Copies","alias":"47b392060f03746d1697749dbb31b328","path":"rhcrpb-id.bre-call_numbers.acn-copies","join":"","reltype":"has_many","idlclass":"acp","table":"asset.copy","fields":{"dis_tab":{"price":{"colname":"price","transform":"max","aggregate":true,"params":null,"transform_label":"Max","alias":"Price","join":"","datatype":"money","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{},"aggfilter_tab":{}}},"a80af59b2a26ae26095dfb0239dccc21":{"label":"Hold/Copy Ratio per Bib -> Bibliographic Record -> Call Number/Volume -> Bibliographic Record :: Fixed Field Entry","alias":"a80af59b2a26ae26095dfb0239dccc21","path":"rhcrpb-id.bre-call_numbers.acn-record.bre-fixed_fields","join":"","reltype":"might_have","idlclass":"mrd","table":"metabib.rec_descriptor","fields":{"dis_tab":{"item_lang":{"colname":"item_lang","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Lang","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{},"aggfilter_tab":{}}}}}', (select f.id from reporter.template_folder f JOIN reporter.template_folder ff on (f.parent = ff.id) where ff.name='EG Custom Reports' and f.name='Acquisitions'));

INSERT INTO reporter.template ("owner", create_time, name, description, data, folder) VALUES (1, now(), 'Popular Titles on Hold', 'Brief inventory list of titles with higher hold/copy ratios.', '{"version":3,"core_class":"rhcrpb","select":[{"alias":"Title","column":{"colname":"title","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-id-bre-simple_record-rmsr-title","relation":"da9f0cb56ef4349e224632f85fbf25f8"},{"alias":"Author","column":{"colname":"author","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-id-bre-simple_record-rmsr-author","relation":"da9f0cb56ef4349e224632f85fbf25f8"},{"alias":"Holdable Copy Count","column":{"colname":"copy_count","transform":"count","transform_label":"Count"},"path":"rhcrpb-copy_count","relation":"210446682bb49afb05aad68eb78b4d4a"},{"alias":"Hold/Copy Ratio","column":{"colname":"hold_copy_ratio","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-hold_copy_ratio","relation":"210446682bb49afb05aad68eb78b4d4a"}],"from":{"path":"rhcrpb-id","table":"(\\n\\n            -- -- If we uncomment the RIGHT JOIN against biblio.record_entry, then well get a row for every non-deleted bib, whether it has active holds or not.\\n            -- -- If we expect to use pcrud to query against specific bibs, we probably want to do this.  However, if were using this to populate a report, we\\n            -- -- may not.\\n            -- SELECT\\n            --     bre.id AS "bib_id",\\n            --     COALESCE( z.copy_count, 0 ) AS "copy_count",\\n            --     COALESCE( z.hold_count, 0 ) AS "hold_count",\\n            --     COALESCE( z.copy_hold_ratio, 0 ) AS "hold_copy_ratio"\\n            -- FROM (\\n                SELECT\\n                    y.bre AS "id",\\n                    COALESCE( x.copy_count, 0 ) AS "copy_count",\\n                    y.hold_count AS "hold_count",\\n                    (y.hold_count::REAL / (CASE WHEN x.copy_count = 0 OR x.copy_count IS NULL THEN 0.1 ELSE x.copy_count::REAL END)) AS "hold_copy_ratio"\\n                FROM (\\n                        SELECT\\n                            (SELECT bib_record FROM reporter.hold_request_record r WHERE r.id = h.id LIMIT 1) AS "bre",\\n                            COUNT(*) AS "hold_count"\\n                        FROM action.hold_request h\\n                        WHERE\\n                            cancel_time IS NULL\\n                            AND fulfillment_time IS NULL\\n                            -- AND NOT frozen  -- a frozen hold is still a desired hold, eh?\\n                        GROUP BY 1\\n                    )y LEFT JOIN (\\n                        SELECT \\n                            (SELECT id\\n                                FROM biblio.record_entry \\n                                WHERE id = (SELECT record FROM asset.call_number WHERE id = call_number)\\n                            ) AS "bre", \\n                            COUNT(*) AS "copy_count"\\n                        FROM asset.copy\\n                            JOIN asset.copy_location loc ON (copy.location = loc.id AND loc.holdable)\\n                        WHERE copy.holdable \\n                            AND NOT copy.deleted \\n                            AND copy.status IN ( SELECT id FROM config.copy_status WHERE holdable ) \\n                        GROUP BY 1\\n                    )x ON x.bre = y.bre\\n                -- )z RIGHT JOIN (\\n                --     SELECT id\\n                --     FROM biblio.record_entry\\n                --     WHERE NOT deleted\\n                -- )bre ON (z.bib_id = bre.id)\\n                \\n\\n\\t\\t)","label":"Hold/Copy Ratio per Bib","alias":"210446682bb49afb05aad68eb78b4d4a","idlclass":"rhcrpb","template_path":"rhcrpb","join":{"id-210446682bb49afb05aad68eb78b4d4a":{"key":"id","type":"left","path":"rhcrpb-id-bre-simple_record","table":"biblio.record_entry","alias":"c2b38d181ecc7e6f29dc9aa17e4b1550","join":{"id-rmsr-id-c2b38d181ecc7e6f29dc9aa17e4b1550":{"type":"left","key":"id","path":"rhcrpb-id-bre-simple_record-rmsr","table":"reporter.materialized_simple_record","label":"Hold/Copy Ratio per Bib -> Bibliographic Record :: Simple Record Extracts ","alias":"da9f0cb56ef4349e224632f85fbf25f8","idlclass":"rmsr","template_path":"rhcrpb-id.bre-simple_record"}}}}},"where":[{"alias":"Hold/Copy Ratio","column":{"colname":"hold_copy_ratio","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-hold_copy_ratio","relation":"210446682bb49afb05aad68eb78b4d4a","condition":{">=":"::P0"}}],"having":[],"order_by":[],"rel_cache":{"210446682bb49afb05aad68eb78b4d4a":{"label":"Hold/Copy Ratio per Bib","alias":"210446682bb49afb05aad68eb78b4d4a","path":"rhcrpb","join":"","reltype":"","idlclass":"rhcrpb","table":"(\\n\\n            -- -- If we uncomment the RIGHT JOIN against biblio.record_entry, then well get a row for every non-deleted bib, whether it has active holds or not.\\n            -- -- If we expect to use pcrud to query against specific bibs, we probably want to do this.  However, if were using this to populate a report, we\\n            -- -- may not.\\n            -- SELECT\\n            --     bre.id AS "bib_id",\\n            --     COALESCE( z.copy_count, 0 ) AS "copy_count",\\n            --     COALESCE( z.hold_count, 0 ) AS "hold_count",\\n            --     COALESCE( z.copy_hold_ratio, 0 ) AS "hold_copy_ratio"\\n            -- FROM (\\n                SELECT\\n                    y.bre AS "id",\\n                    COALESCE( x.copy_count, 0 ) AS "copy_count",\\n                    y.hold_count AS "hold_count",\\n                    (y.hold_count::REAL / (CASE WHEN x.copy_count = 0 OR x.copy_count IS NULL THEN 0.1 ELSE x.copy_count::REAL END)) AS "hold_copy_ratio"\\n                FROM (\\n                        SELECT\\n                            (SELECT bib_record FROM reporter.hold_request_record r WHERE r.id = h.id LIMIT 1) AS "bre",\\n                            COUNT(*) AS "hold_count"\\n                        FROM action.hold_request h\\n                        WHERE\\n                            cancel_time IS NULL\\n                            AND fulfillment_time IS NULL\\n                            -- AND NOT frozen  -- a frozen hold is still a desired hold, eh?\\n                        GROUP BY 1\\n                    )y LEFT JOIN (\\n                        SELECT \\n                            (SELECT id\\n                                FROM biblio.record_entry \\n                                WHERE id = (SELECT record FROM asset.call_number WHERE id = call_number)\\n                            ) AS "bre", \\n                            COUNT(*) AS "copy_count"\\n                        FROM asset.copy\\n                            JOIN asset.copy_location loc ON (copy.location = loc.id AND loc.holdable)\\n                        WHERE copy.holdable \\n                            AND NOT copy.deleted \\n                            AND copy.status IN ( SELECT id FROM config.copy_status WHERE holdable ) \\n                        GROUP BY 1\\n                    )x ON x.bre = y.bre\\n                -- )z RIGHT JOIN (\\n                --     SELECT id\\n                --     FROM biblio.record_entry\\n                --     WHERE NOT deleted\\n                -- )bre ON (z.bib_id = bre.id)\\n                \\n\\n\\t\\t)","fields":{"dis_tab":{"copy_count":{"colname":"copy_count","transform":"count","aggregate":true,"params":null,"transform_label":"Count","alias":"Holdable Copy Count","join":"","datatype":"int","op":"=","op_label":"Equals","op_value":{}},"hold_copy_ratio":{"colname":"hold_copy_ratio","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Hold/Copy Ratio","join":"","datatype":"float","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{"hold_copy_ratio":{"colname":"hold_copy_ratio","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Hold/Copy Ratio","join":"","datatype":"float","op":">=","op_label":"Greater than or equal to","op_value":{}}},"aggfilter_tab":{}}},"order_by":[{"relation":"da9f0cb56ef4349e224632f85fbf25f8","field":"title"},{"relation":"da9f0cb56ef4349e224632f85fbf25f8","field":"author"},{"relation":"210446682bb49afb05aad68eb78b4d4a","field":"copy_count"},{"relation":"210446682bb49afb05aad68eb78b4d4a","field":"hold_copy_ratio"}],"da9f0cb56ef4349e224632f85fbf25f8":{"label":"Hold/Copy Ratio per Bib -> Bibliographic Record :: Simple Record Extracts ","alias":"da9f0cb56ef4349e224632f85fbf25f8","path":"rhcrpb-id.bre-simple_record","join":"","reltype":"might_have","idlclass":"rmsr","table":"reporter.materialized_simple_record","fields":{"dis_tab":{"author":{"colname":"author","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Author","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}},"title":{"colname":"title","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Title","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{},"aggfilter_tab":{}}}}}', (select f.id from reporter.template_folder f JOIN reporter.template_folder ff on (f.parent = ff.id) where ff.name='EG Custom Reports' and f.name='Acquisitions'));

INSERT INTO reporter.template ("owner", create_time, name, description, data, folder) VALUES (1, now(), 'Size of Collection Report', 'Display of copies by owning library and shelving location with a count of total circulations based on library and checkout date range.', '{"version":3,"core_class":"acp","select":[{"alias":"Owning Library","column":{"colname":"name","transform":"Bare","transform_label":"Raw Data"},"path":"acp-call_number-acn-owning_lib-aou-name","relation":"bdd43e1440a00047b1e66cb9619865c0"},{"alias":"Shelving Location","column":{"colname":"name","transform":"Bare","transform_label":"Raw Data"},"path":"acp-location-acpl-name","relation":"c17ecc44e3cd2de457e5c9f1e6e0a26f"},{"alias":"# of Copies","column":{"colname":"id","transform":"count","transform_label":"Count"},"path":"acp-id","relation":"7d74f3b92b19da5e606d737d339a9679"},{"alias":"# of Circulations","column":{"colname":"id","transform":"count","transform_label":"Count"},"path":"acp-circulations-circ-id","relation":"ddeeaf1839fe1496b309babab563fea7"}],"from":{"path":"acp-call_number","table":"asset.copy","label":"Item","alias":"7d74f3b92b19da5e606d737d339a9679","idlclass":"acp","template_path":"acp","join":{"call_number-7d74f3b92b19da5e606d737d339a9679":{"key":"id","path":"acp-call_number-acn","table":"asset.call_number","alias":"286d7899ae25bee8bdd7dcde49f9e0b7","join":{"owning_lib-6d47a03270f761656e30bab94ee64d38":{"key":"id","path":"acp-call_number-acn-owning_lib-aou","table":"actor.org_unit","label":"Item -> Call Number/Volume :: Owning Library","alias":"bdd43e1440a00047b1e66cb9619865c0","idlclass":"aou","template_path":"acp-call_number.acn-owning_lib"}},"label":"Item :: Call Number/Volume","idlclass":"acn","template_path":"acp-call_number"},"location-7d74f3b92b19da5e606d737d339a9679":{"key":"id","path":"acp-location-acpl","table":"asset.copy_location","label":"Item :: Shelving Location","alias":"c17ecc44e3cd2de457e5c9f1e6e0a26f","idlclass":"acpl","template_path":"acp-location"},"id-circ-target_copy-7d74f3b92b19da5e606d737d339a9679":{"key":"target_copy","type":"left","path":"acp-circulations-circ","table":"action.circulation","label":"Item :: Circulations","alias":"ddeeaf1839fe1496b309babab563fea7","idlclass":"circ","template_path":"acp-circulations"}}},"where":[{"alias":"Check Out Date/Time","column":{"colname":"xact_start","transform":"date","transform_label":"Date"},"path":"acp-circulations-circ-xact_start","relation":"ddeeaf1839fe1496b309babab563fea7","condition":{"between":"::P0"}},{"alias":"Owning Library","column":{"colname":"owning_lib","transform":"Bare","transform_label":"Raw Data"},"path":"acp-call_number-acn-owning_lib","relation":"286d7899ae25bee8bdd7dcde49f9e0b7","condition":{"in":"::P1"}}],"having":[],"order_by":[],"rel_cache":{"7d74f3b92b19da5e606d737d339a9679":{"label":"Item","alias":"7d74f3b92b19da5e606d737d339a9679","path":"acp","join":"","reltype":"","idlclass":"acp","table":"asset.copy","fields":{"dis_tab":{"id":{"colname":"id","transform":"count","aggregate":true,"params":null,"transform_label":"Count","alias":"# of Copies","join":"","datatype":"id","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{},"aggfilter_tab":{}}},"order_by":[{"relation":"bdd43e1440a00047b1e66cb9619865c0","field":"name"},{"relation":"c17ecc44e3cd2de457e5c9f1e6e0a26f","field":"name"},{"relation":"7d74f3b92b19da5e606d737d339a9679","field":"id"},{"relation":"ddeeaf1839fe1496b309babab563fea7","field":"id"}],"bdd43e1440a00047b1e66cb9619865c0":{"label":"Item -> Call Number/Volume :: Owning Library","alias":"bdd43e1440a00047b1e66cb9619865c0","path":"acp-call_number.acn-owning_lib","join":"","reltype":"has_a","idlclass":"aou","table":"actor.org_unit","fields":{"dis_tab":{"name":{"colname":"name","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Owning Library","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{},"aggfilter_tab":{}}},"c17ecc44e3cd2de457e5c9f1e6e0a26f":{"label":"Item :: Shelving Location","alias":"c17ecc44e3cd2de457e5c9f1e6e0a26f","path":"acp-location","join":"","reltype":"has_a","idlclass":"acpl","table":"asset.copy_location","fields":{"dis_tab":{"name":{"colname":"name","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Shelving Location","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{},"aggfilter_tab":{}}},"ddeeaf1839fe1496b309babab563fea7":{"label":"Item :: Circulations","alias":"ddeeaf1839fe1496b309babab563fea7","path":"acp-circulations","join":"","reltype":"has_many","idlclass":"circ","table":"action.circulation","fields":{"dis_tab":{"id":{"colname":"id","transform":"count","aggregate":true,"params":null,"transform_label":"Count","alias":"# of Circulations","join":"","datatype":"id","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{"xact_start":{"colname":"xact_start","transform":"date","aggregate":null,"params":null,"transform_label":"Date","alias":"Check Out Date/Time","join":"","datatype":"timestamp","op":"between","op_label":"Between","op_value":{}}},"aggfilter_tab":{}}},"286d7899ae25bee8bdd7dcde49f9e0b7":{"label":"Item :: Call Number/Volume","alias":"286d7899ae25bee8bdd7dcde49f9e0b7","path":"acp-call_number","join":"","reltype":"has_a","idlclass":"acn","table":"asset.call_number","fields":{"dis_tab":{},"filter_tab":{"owning_lib":{"colname":"owning_lib","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Owning Library","join":"","datatype":"org_unit","op":"in","op_label":"In list","op_value":{}}},"aggfilter_tab":{}}}}}', (select f.id from reporter.template_folder f JOIN reporter.template_folder ff on (f.parent = ff.id) where ff.name='EG Custom Reports' and f.name='Acquisitions'));
INSERT INTO reporter.template ("owner", create_time, name, description, data, folder) VALUES (1, now(), 'YTD Circs by Owning Library and Shelving Location', 'Display of items by owning library and shelving location with their YTD circulation count (based on selected checkout date range).', '{"version":3,"core_class":"acp","select":[{"alias":"Owning Library","column":{"colname":"name","transform":"Bare","transform_label":"Raw Data"},"path":"acp-call_number-acn-owning_lib-aou-name","relation":"bdd43e1440a00047b1e66cb9619865c0"},{"alias":"Shelving Location","column":{"colname":"name","transform":"Bare","transform_label":"Raw Data"},"path":"acp-location-acpl-name","relation":"c17ecc44e3cd2de457e5c9f1e6e0a26f"},{"alias":"# of Copies","column":{"colname":"id","transform":"count","transform_label":"Count"},"path":"acp-id","relation":"7d74f3b92b19da5e606d737d339a9679"},{"alias":"# of Circulations","column":{"colname":"id","transform":"count","transform_label":"Count"},"path":"acp-circulations-circ-id","relation":"ddeeaf1839fe1496b309babab563fea7"}],"from":{"path":"acp-call_number","table":"asset.copy","label":"Item","alias":"7d74f3b92b19da5e606d737d339a9679","idlclass":"acp","template_path":"acp","join":{"call_number-7d74f3b92b19da5e606d737d339a9679":{"key":"id","path":"acp-call_number-acn","table":"asset.call_number","alias":"286d7899ae25bee8bdd7dcde49f9e0b7","join":{"owning_lib-6d47a03270f761656e30bab94ee64d38":{"key":"id","path":"acp-call_number-acn-owning_lib-aou","table":"actor.org_unit","label":"Item -> Call Number/Volume :: Owning Library","alias":"bdd43e1440a00047b1e66cb9619865c0","idlclass":"aou","template_path":"acp-call_number.acn-owning_lib"}},"label":"Item :: Call Number/Volume","idlclass":"acn","template_path":"acp-call_number"},"location-7d74f3b92b19da5e606d737d339a9679":{"key":"id","path":"acp-location-acpl","table":"asset.copy_location","label":"Item :: Shelving Location","alias":"c17ecc44e3cd2de457e5c9f1e6e0a26f","idlclass":"acpl","template_path":"acp-location"},"id-circ-target_copy-7d74f3b92b19da5e606d737d339a9679":{"key":"target_copy","type":"left","path":"acp-circulations-circ","table":"action.circulation","label":"Item :: Circulations","alias":"ddeeaf1839fe1496b309babab563fea7","idlclass":"circ","template_path":"acp-circulations"}}},"where":[{"alias":"Check Out Date/Time","column":{"colname":"xact_start","transform":"date","transform_label":"Date"},"path":"acp-circulations-circ-xact_start","relation":"ddeeaf1839fe1496b309babab563fea7","condition":{"between":"::P0"}},{"alias":"Owning Library","column":{"colname":"owning_lib","transform":"Bare","transform_label":"Raw Data"},"path":"acp-call_number-acn-owning_lib","relation":"286d7899ae25bee8bdd7dcde49f9e0b7","condition":{"in":"::P1"}}],"having":[],"order_by":[],"rel_cache":{"7d74f3b92b19da5e606d737d339a9679":{"label":"Item","alias":"7d74f3b92b19da5e606d737d339a9679","path":"acp","join":"","reltype":"","idlclass":"acp","table":"asset.copy","fields":{"dis_tab":{"id":{"colname":"id","transform":"count","aggregate":true,"params":null,"transform_label":"Count","alias":"# of Copies","join":"","datatype":"id","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{},"aggfilter_tab":{}}},"order_by":[{"relation":"bdd43e1440a00047b1e66cb9619865c0","field":"name"},{"relation":"c17ecc44e3cd2de457e5c9f1e6e0a26f","field":"name"},{"relation":"7d74f3b92b19da5e606d737d339a9679","field":"id"},{"relation":"ddeeaf1839fe1496b309babab563fea7","field":"id"}],"bdd43e1440a00047b1e66cb9619865c0":{"label":"Item -> Call Number/Volume :: Owning Library","alias":"bdd43e1440a00047b1e66cb9619865c0","path":"acp-call_number.acn-owning_lib","join":"","reltype":"has_a","idlclass":"aou","table":"actor.org_unit","fields":{"dis_tab":{"name":{"colname":"name","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Owning Library","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{},"aggfilter_tab":{}}},"c17ecc44e3cd2de457e5c9f1e6e0a26f":{"label":"Item :: Shelving Location","alias":"c17ecc44e3cd2de457e5c9f1e6e0a26f","path":"acp-location","join":"","reltype":"has_a","idlclass":"acpl","table":"asset.copy_location","fields":{"dis_tab":{"name":{"colname":"name","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Shelving Location","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{},"aggfilter_tab":{}}},"ddeeaf1839fe1496b309babab563fea7":{"label":"Item :: Circulations","alias":"ddeeaf1839fe1496b309babab563fea7","path":"acp-circulations","join":"","reltype":"has_many","idlclass":"circ","table":"action.circulation","fields":{"dis_tab":{"id":{"colname":"id","transform":"count","aggregate":true,"params":null,"transform_label":"Count","alias":"# of Circulations","join":"","datatype":"id","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{"xact_start":{"colname":"xact_start","transform":"date","aggregate":null,"params":null,"transform_label":"Date","alias":"Check Out Date/Time","join":"","datatype":"timestamp","op":"between","op_label":"Between","op_value":{}}},"aggfilter_tab":{}}},"286d7899ae25bee8bdd7dcde49f9e0b7":{"label":"Item :: Call Number/Volume","alias":"286d7899ae25bee8bdd7dcde49f9e0b7","path":"acp-call_number","join":"","reltype":"has_a","idlclass":"acn","table":"asset.call_number","fields":{"dis_tab":{},"filter_tab":{"owning_lib":{"colname":"owning_lib","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Owning Library","join":"","datatype":"org_unit","op":"in","op_label":"In list","op_value":{}}},"aggfilter_tab":{}}}}}', (select f.id from reporter.template_folder f JOIN reporter.template_folder ff on (f.parent = ff.id) where ff.name='EG Custom Reports' and f.name='Acquisitions'));
INSERT INTO reporter.template ("owner", create_time, name, description, data, folder) VALUES (1, now(), 'NEW Purchase Alerts Report', 'Displays lang, call number, record id, author, title, isbn, publisher, pub year, price, holdable copy count, active holds and hold/copy ratio. Filtered by ratio and call number range.', '{"version":3,"core_class":"rhcrpb","select":[{"alias":"Lang","column":{"colname":"item_lang","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-id-bre-call_numbers-acn-record-bre-fixed_fields-mrd-item_lang","relation":"a80af59b2a26ae26095dfb0239dccc21"},{"alias":"Call Number","column":{"colname":"label","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-id-bre-call_numbers-acn-label","relation":"55fb42231a310eb83c192b8a99d74bdb"},{"alias":"Record ID","column":{"colname":"id","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-id-bre-id","relation":"9d45f36e3ae17a229e66552c812dbdf7"},{"alias":"Author","column":{"colname":"author","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-id-bre-call_numbers-acn-record-bre-simple_record-rmsr-author","relation":"75c8a58d5abe6bc1c44b5c6732ae8e48"},{"alias":"Title","column":{"colname":"title","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-id-bre-call_numbers-acn-record-bre-simple_record-rmsr-title","relation":"75c8a58d5abe6bc1c44b5c6732ae8e48"},{"alias":"ISBN","column":{"colname":"isbn","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-id-bre-call_numbers-acn-record-bre-simple_record-rmsr-isbn","relation":"75c8a58d5abe6bc1c44b5c6732ae8e48"},{"alias":"Publisher","column":{"colname":"publisher","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-id-bre-call_numbers-acn-record-bre-simple_record-rmsr-publisher","relation":"75c8a58d5abe6bc1c44b5c6732ae8e48"},{"alias":"Pub Yr","column":{"colname":"pubdate","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-id-bre-call_numbers-acn-record-bre-simple_record-rmsr-pubdate","relation":"75c8a58d5abe6bc1c44b5c6732ae8e48"},{"alias":"Price","column":{"colname":"price","transform":"max","transform_label":"Max"},"path":"rhcrpb-id-bre-call_numbers-acn-copies-acp-price","relation":"47b392060f03746d1697749dbb31b328"},{"alias":"Holdable Copy Count","column":{"colname":"copy_count","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-copy_count","relation":"210446682bb49afb05aad68eb78b4d4a"},{"alias":"Active Holds","column":{"colname":"hold_count","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-hold_count","relation":"210446682bb49afb05aad68eb78b4d4a"},{"alias":"Hold/Copy Ratio","column":{"colname":"hold_copy_ratio","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-hold_copy_ratio","relation":"210446682bb49afb05aad68eb78b4d4a"}],"from":{"path":"rhcrpb","table":"(\\n\\n            -- -- If we uncomment the RIGHT JOIN against biblio.record_entry, then well get a row for every non-deleted bib, whether it has active holds or not.\\n            -- -- If we expect to use pcrud to query against specific bibs, we probably want to do this.  However, if were using this to populate a report, we\\n            -- -- may not.\\n            -- SELECT\\n            --     bre.id AS \\"bib_id\\",\\n            --     COALESCE( z.copy_count, 0 ) AS \\"copy_count\\",\\n            --     COALESCE( z.hold_count, 0 ) AS \\"hold_count\\",\\n            --     COALESCE( z.copy_hold_ratio, 0 ) AS \\"hold_copy_ratio\\"\\n            -- FROM (\\n                SELECT\\n                    y.bre AS \\"id\\",\\n                    COALESCE( x.copy_count, 0 ) AS \\"copy_count\\",\\n                    y.hold_count AS \\"hold_count\\",\\n                    (y.hold_count::REAL / (CASE WHEN x.copy_count = 0 OR x.copy_count IS NULL THEN 0.1 ELSE x.copy_count::REAL END)) AS \\"hold_copy_ratio\\"\\n                FROM (\\n                        SELECT\\n                            (SELECT bib_record FROM reporter.hold_request_record r WHERE r.id = h.id LIMIT 1) AS \\"bre\\",\\n                            COUNT(*) AS \\"hold_count\\"\\n                        FROM action.hold_request h\\n                        WHERE\\n                            cancel_time IS NULL\\n                            AND fulfillment_time IS NULL\\n                            -- AND NOT frozen  -- a frozen hold is still a desired hold, eh?\\n                        GROUP BY 1\\n                    )y LEFT JOIN (\\n                        SELECT \\n                            (SELECT id\\n                                FROM biblio.record_entry \\n                                WHERE id = (SELECT record FROM asset.call_number WHERE id = call_number)\\n                            ) AS \\"bre\\", \\n                            COUNT(*) AS \\"copy_count\\"\\n                        FROM asset.copy\\n                            JOIN asset.copy_location loc ON (copy.location = loc.id AND loc.holdable)\\n                        WHERE copy.holdable \\n                            AND NOT copy.deleted \\n                            AND copy.status IN ( SELECT id FROM config.copy_status WHERE holdable ) \\n                        GROUP BY 1\\n                    )x ON x.bre = y.bre\\n                -- )z RIGHT JOIN (\\n                --     SELECT id\\n                --     FROM biblio.record_entry\\n                --     WHERE NOT deleted\\n                -- )bre ON (z.bib_id = bre.id)\\n                \\n\\n\\t\\t)","alias":"210446682bb49afb05aad68eb78b4d4a","join":{"id-1eb9468ea961f41a5b6d57697e94bf8d":{"key":"id","type":"left","path":"rhcrpb-id-bre-call_numbers","table":"biblio.record_entry","alias":"9d45f36e3ae17a229e66552c812dbdf7","join":{"id-acn-record-c6ef07df4e9ca6435088cc8051c66ddf":{"type":"left","key":"record","path":"rhcrpb-id-bre-call_numbers-acn","table":"asset.call_number","alias":"55fb42231a310eb83c192b8a99d74bdb","join":{"record-0879b2c65951d7588f1458812f9fe412":{"type":"left","key":"id","path":"rhcrpb-id-bre-call_numbers-acn-record-bre-fixed_fields","table":"biblio.record_entry","alias":"cb6ace8c7a3586c69a35a94ce8dadadf","join":{"id-mrd-record-cb6ace8c7a3586c69a35a94ce8dadadf":{"type":"left","key":"record","path":"rhcrpb-id-bre-call_numbers-acn-record-bre-fixed_fields-mrd","table":"metabib.rec_descriptor","label":"Hold/Copy Ratio per Bib -> Bibliographic Record -> Call Number/Volume -> Bibliographic Record :: Fixed Field Entry","alias":"a80af59b2a26ae26095dfb0239dccc21","idlclass":"mrd","template_path":"rhcrpb-id.bre-call_numbers.acn-record.bre-fixed_fields"}}}},"label":"Hold/Copy Ratio per Bib -> Bibliographic Record :: Call Numbers","idlclass":"acn","template_path":"rhcrpb-id.bre-call_numbers"},"id-acn-record-9d45f36e3ae17a229e66552c812dbdf7":{"type":"left","key":"record","path":"rhcrpb-id-bre-call_numbers-acn-copies","table":"asset.call_number","alias":"0879b2c65951d7588f1458812f9fe412","join":{"record-0879b2c65951d7588f1458812f9fe412":{"type":"left","key":"id","path":"rhcrpb-id-bre-call_numbers-acn-record-bre-simple_record","table":"biblio.record_entry","alias":"7819442c81696292e3666b196018b8c0","join":{"id-rmsr-id-7819442c81696292e3666b196018b8c0":{"type":"left","key":"id","path":"rhcrpb-id-bre-call_numbers-acn-record-bre-simple_record-rmsr","table":"reporter.materialized_simple_record","label":"Hold/Copy Ratio per Bib -> Bibliographic Record -> Call Number/Volume -> Bibliographic Record :: Simple Record Extracts ","alias":"75c8a58d5abe6bc1c44b5c6732ae8e48","idlclass":"rmsr","template_path":"rhcrpb-id.bre-call_numbers.acn-record.bre-simple_record"}}},"id-acp-call_number-0879b2c65951d7588f1458812f9fe412":{"type":"left","key":"call_number","path":"rhcrpb-id-bre-call_numbers-acn-copies-acp","table":"asset.copy","label":"Hold/Copy Ratio per Bib -> Bibliographic Record -> Call Number/Volume :: Copies","alias":"47b392060f03746d1697749dbb31b328","idlclass":"acp","template_path":"rhcrpb-id.bre-call_numbers.acn-copies"}}}},"label":"Hold/Copy Ratio per Bib :: Record ID","idlclass":"bre","template_path":"rhcrpb-id"}},"label":"Hold/Copy Ratio per Bib","idlclass":"rhcrpb","template_path":"rhcrpb"},"where":[{"alias":"Call Number Label","column":{"colname":"label","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-id-bre-call_numbers-acn-label","relation":"55fb42231a310eb83c192b8a99d74bdb","condition":{"between":"::P0"}},{"alias":"Hold/Copy Ratio","column":{"colname":"hold_copy_ratio","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-hold_copy_ratio","relation":"210446682bb49afb05aad68eb78b4d4a","condition":{">=":"::P1"}}],"having":[],"order_by":[],"rel_cache":{"a80af59b2a26ae26095dfb0239dccc21":{"label":"Hold/Copy Ratio per Bib -> Bibliographic Record -> Call Number/Volume -> Bibliographic Record :: Fixed Field Entry","alias":"a80af59b2a26ae26095dfb0239dccc21","path":"rhcrpb-id.bre-call_numbers.acn-record.bre-fixed_fields","join":"","reltype":"might_have","idlclass":"mrd","table":"metabib.rec_descriptor","fields":{"dis_tab":{"item_lang":{"colname":"item_lang","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Lang","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{},"aggfilter_tab":{}}},"order_by":[{"relation":"a80af59b2a26ae26095dfb0239dccc21","field":"item_lang"},{"relation":"55fb42231a310eb83c192b8a99d74bdb","field":"label"},{"relation":"9d45f36e3ae17a229e66552c812dbdf7","field":"id"},{"relation":"75c8a58d5abe6bc1c44b5c6732ae8e48","field":"author"},{"relation":"75c8a58d5abe6bc1c44b5c6732ae8e48","field":"title"},{"relation":"75c8a58d5abe6bc1c44b5c6732ae8e48","field":"isbn"},{"relation":"75c8a58d5abe6bc1c44b5c6732ae8e48","field":"publisher"},{"relation":"75c8a58d5abe6bc1c44b5c6732ae8e48","field":"pubdate"},{"relation":"47b392060f03746d1697749dbb31b328","field":"price"},{"relation":"210446682bb49afb05aad68eb78b4d4a","field":"copy_count"},{"relation":"210446682bb49afb05aad68eb78b4d4a","field":"hold_count"},{"relation":"210446682bb49afb05aad68eb78b4d4a","field":"hold_copy_ratio"}],"55fb42231a310eb83c192b8a99d74bdb":{"label":"Hold/Copy Ratio per Bib -> Bibliographic Record :: Call Numbers","alias":"55fb42231a310eb83c192b8a99d74bdb","path":"rhcrpb-id.bre-call_numbers","join":"","reltype":"has_many","idlclass":"acn","table":"asset.call_number","fields":{"dis_tab":{"label":{"colname":"label","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Call Number","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{"label":{"colname":"label","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Call Number Label","join":"","datatype":"text","op":"between","op_label":"Between","op_value":{}}},"aggfilter_tab":{}}},"9d45f36e3ae17a229e66552c812dbdf7":{"label":"Hold/Copy Ratio per Bib :: Record ID","alias":"9d45f36e3ae17a229e66552c812dbdf7","path":"rhcrpb-id","join":"","reltype":"has_a","idlclass":"bre","table":"biblio.record_entry","fields":{"dis_tab":{"id":{"colname":"id","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Record ID","join":"","datatype":"id","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{},"aggfilter_tab":{}}},"75c8a58d5abe6bc1c44b5c6732ae8e48":{"label":"Hold/Copy Ratio per Bib -> Bibliographic Record -> Call Number/Volume -> Bibliographic Record :: Simple Record Extracts ","alias":"75c8a58d5abe6bc1c44b5c6732ae8e48","path":"rhcrpb-id.bre-call_numbers.acn-record.bre-simple_record","join":"","reltype":"might_have","idlclass":"rmsr","table":"reporter.materialized_simple_record","fields":{"dis_tab":{"author":{"colname":"author","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Author","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}},"title":{"colname":"title","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Title","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}},"isbn":{"colname":"isbn","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"ISBN","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}},"publisher":{"colname":"publisher","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Publisher","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}},"pubdate":{"colname":"pubdate","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Pub Yr","join":"","datatype":"int","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{},"aggfilter_tab":{}}},"47b392060f03746d1697749dbb31b328":{"label":"Hold/Copy Ratio per Bib -> Bibliographic Record -> Call Number/Volume :: Copies","alias":"47b392060f03746d1697749dbb31b328","path":"rhcrpb-id.bre-call_numbers.acn-copies","join":"","reltype":"has_many","idlclass":"acp","table":"asset.copy","fields":{"dis_tab":{"price":{"colname":"price","transform":"max","aggregate":true,"params":null,"transform_label":"Max","alias":"Price","join":"","datatype":"money","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{},"aggfilter_tab":{}}},"210446682bb49afb05aad68eb78b4d4a":{"label":"Hold/Copy Ratio per Bib","alias":"210446682bb49afb05aad68eb78b4d4a","path":"rhcrpb","join":"","reltype":"","idlclass":"rhcrpb","table":"(\\n\\n            -- -- If we uncomment the RIGHT JOIN against biblio.record_entry, then well get a row for every non-deleted bib, whether it has active holds or not.\\n            -- -- If we expect to use pcrud to query against specific bibs, we probably want to do this.  However, if were using this to populate a report, we\\n            -- -- may not.\\n            -- SELECT\\n            --     bre.id AS \\"bib_id\\",\\n            --     COALESCE( z.copy_count, 0 ) AS \\"copy_count\\",\\n            --     COALESCE( z.hold_count, 0 ) AS \\"hold_count\\",\\n            --     COALESCE( z.copy_hold_ratio, 0 ) AS \\"hold_copy_ratio\\"\\n            -- FROM (\\n                SELECT\\n                    y.bre AS \\"id\\",\\n                    COALESCE( x.copy_count, 0 ) AS \\"copy_count\\",\\n                    y.hold_count AS \\"hold_count\\",\\n                    (y.hold_count::REAL / (CASE WHEN x.copy_count = 0 OR x.copy_count IS NULL THEN 0.1 ELSE x.copy_count::REAL END)) AS \\"hold_copy_ratio\\"\\n                FROM (\\n                        SELECT\\n                            (SELECT bib_record FROM reporter.hold_request_record r WHERE r.id = h.id LIMIT 1) AS \\"bre\\",\\n                            COUNT(*) AS \\"hold_count\\"\\n                        FROM action.hold_request h\\n                        WHERE\\n                            cancel_time IS NULL\\n                            AND fulfillment_time IS NULL\\n                            -- AND NOT frozen  -- a frozen hold is still a desired hold, eh?\\n                        GROUP BY 1\\n                    )y LEFT JOIN (\\n                        SELECT \\n                            (SELECT id\\n                                FROM biblio.record_entry \\n                                WHERE id = (SELECT record FROM asset.call_number WHERE id = call_number)\\n                            ) AS \\"bre\\", \\n                            COUNT(*) AS \\"copy_count\\"\\n                        FROM asset.copy\\n                            JOIN asset.copy_location loc ON (copy.location = loc.id AND loc.holdable)\\n                        WHERE copy.holdable \\n                            AND NOT copy.deleted \\n                            AND copy.status IN ( SELECT id FROM config.copy_status WHERE holdable ) \\n                        GROUP BY 1\\n                    )x ON x.bre = y.bre\\n                -- )z RIGHT JOIN (\\n                --     SELECT id\\n                --     FROM biblio.record_entry\\n                --     WHERE NOT deleted\\n                -- )bre ON (z.bib_id = bre.id)\\n                \\n\\n\\t\\t)","fields":{"dis_tab":{"copy_count":{"colname":"copy_count","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Holdable Copy Count","join":"","datatype":"int","op":"=","op_label":"Equals","op_value":{}},"hold_count":{"colname":"hold_count","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Active Holds","join":"","datatype":"int","op":"=","op_label":"Equals","op_value":{}},"hold_copy_ratio":{"colname":"hold_copy_ratio","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Hold/Copy Ratio","join":"","datatype":"float","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{"hold_copy_ratio":{"colname":"hold_copy_ratio","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Hold/Copy Ratio","join":"","datatype":"float","op":">=","op_label":"Greater than or equal to","op_value":{}}},"aggfilter_tab":{}}}}}', (select f.id from reporter.template_folder f JOIN reporter.template_folder ff on (f.parent = ff.id) where ff.name='EG Custom Reports' and f.name='Acquisitions'));

INSERT INTO reporter.template ("owner", create_time, name, description, data, folder) VALUES (1, now(), 'NEW Popular Titles on Hold', 'A brief inventory of titles with higher hold/copy ratios.', '{"version":3,"core_class":"rhcrpb","select":[{"alias":"Title","column":{"colname":"title","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-id-bre-call_numbers-acn-record-bre-simple_record-rmsr-title","relation":"75c8a58d5abe6bc1c44b5c6732ae8e48"},{"alias":"Author","column":{"colname":"author","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-id-bre-call_numbers-acn-record-bre-simple_record-rmsr-author","relation":"75c8a58d5abe6bc1c44b5c6732ae8e48"},{"alias":"Holdable Copy Count","column":{"colname":"copy_count","transform":"count","transform_label":"Count"},"path":"rhcrpb-copy_count","relation":"210446682bb49afb05aad68eb78b4d4a"},{"alias":"Hold/Copy Ratio","column":{"colname":"hold_copy_ratio","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-hold_copy_ratio","relation":"210446682bb49afb05aad68eb78b4d4a"}],"from":{"path":"rhcrpb","table":"(\\n\\n            -- -- If we uncomment the RIGHT JOIN against biblio.record_entry, then well get a row for every non-deleted bib, whether it has active holds or not.\\n            -- -- If we expect to use pcrud to query against specific bibs, we probably want to do this.  However, if were using this to populate a report, we\\n            -- -- may not.\\n            -- SELECT\\n            --     bre.id AS \\"bib_id\\",\\n            --     COALESCE( z.copy_count, 0 ) AS \\"copy_count\\",\\n            --     COALESCE( z.hold_count, 0 ) AS \\"hold_count\\",\\n            --     COALESCE( z.copy_hold_ratio, 0 ) AS \\"hold_copy_ratio\\"\\n            -- FROM (\\n                SELECT\\n                    y.bre AS \\"id\\",\\n                    COALESCE( x.copy_count, 0 ) AS \\"copy_count\\",\\n                    y.hold_count AS \\"hold_count\\",\\n                    (y.hold_count::REAL / (CASE WHEN x.copy_count = 0 OR x.copy_count IS NULL THEN 0.1 ELSE x.copy_count::REAL END)) AS \\"hold_copy_ratio\\"\\n                FROM (\\n                        SELECT\\n                            (SELECT bib_record FROM reporter.hold_request_record r WHERE r.id = h.id LIMIT 1) AS \\"bre\\",\\n                            COUNT(*) AS \\"hold_count\\"\\n                        FROM action.hold_request h\\n                        WHERE\\n                            cancel_time IS NULL\\n                            AND fulfillment_time IS NULL\\n                            -- AND NOT frozen  -- a frozen hold is still a desired hold, eh?\\n                        GROUP BY 1\\n                    )y LEFT JOIN (\\n                        SELECT \\n                            (SELECT id\\n                                FROM biblio.record_entry \\n                                WHERE id = (SELECT record FROM asset.call_number WHERE id = call_number)\\n                            ) AS \\"bre\\", \\n                            COUNT(*) AS \\"copy_count\\"\\n                        FROM asset.copy\\n                            JOIN asset.copy_location loc ON (copy.location = loc.id AND loc.holdable)\\n                        WHERE copy.holdable \\n                            AND NOT copy.deleted \\n                            AND copy.status IN ( SELECT id FROM config.copy_status WHERE holdable ) \\n                        GROUP BY 1\\n                    )x ON x.bre = y.bre\\n                -- )z RIGHT JOIN (\\n                --     SELECT id\\n                --     FROM biblio.record_entry\\n                --     WHERE NOT deleted\\n                -- )bre ON (z.bib_id = bre.id)\\n                \\n\\n\\t\\t)","alias":"210446682bb49afb05aad68eb78b4d4a","join":{"id-1eb9468ea961f41a5b6d57697e94bf8d":{"key":"id","type":"left","path":"rhcrpb-id-bre-call_numbers","table":"biblio.record_entry","alias":"c6ef07df4e9ca6435088cc8051c66ddf","join":{"id-acn-record-c6ef07df4e9ca6435088cc8051c66ddf":{"type":"left","key":"record","path":"rhcrpb-id-bre-call_numbers-acn-record","table":"asset.call_number","alias":"0879b2c65951d7588f1458812f9fe412","join":{"record-0879b2c65951d7588f1458812f9fe412":{"type":"left","key":"id","path":"rhcrpb-id-bre-call_numbers-acn-record-bre-simple_record","table":"biblio.record_entry","alias":"7819442c81696292e3666b196018b8c0","join":{"id-rmsr-id-7819442c81696292e3666b196018b8c0":{"type":"left","key":"id","path":"rhcrpb-id-bre-call_numbers-acn-record-bre-simple_record-rmsr","table":"reporter.materialized_simple_record","label":"Hold/Copy Ratio per Bib -> Bibliographic Record -> Call Number/Volume -> Bibliographic Record :: Simple Record Extracts ","alias":"75c8a58d5abe6bc1c44b5c6732ae8e48","idlclass":"rmsr","template_path":"rhcrpb-id.bre-call_numbers.acn-record.bre-simple_record"}}}}}}}},"label":"Hold/Copy Ratio per Bib","idlclass":"rhcrpb","template_path":"rhcrpb"},"where":[{"alias":"Hold/Copy Ratio","column":{"colname":"hold_copy_ratio","transform":"Bare","transform_label":"Raw Data"},"path":"rhcrpb-hold_copy_ratio","relation":"210446682bb49afb05aad68eb78b4d4a","condition":{">=":"::P0"}}],"having":[],"order_by":[],"rel_cache":{"75c8a58d5abe6bc1c44b5c6732ae8e48":{"label":"Hold/Copy Ratio per Bib -> Bibliographic Record -> Call Number/Volume -> Bibliographic Record :: Simple Record Extracts ","alias":"75c8a58d5abe6bc1c44b5c6732ae8e48","path":"rhcrpb-id.bre-call_numbers.acn-record.bre-simple_record","join":"","reltype":"might_have","idlclass":"rmsr","table":"reporter.materialized_simple_record","fields":{"dis_tab":{"title":{"colname":"title","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Title","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}},"author":{"colname":"author","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Author","join":"","datatype":"text","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{},"aggfilter_tab":{}}},"order_by":[{"relation":"75c8a58d5abe6bc1c44b5c6732ae8e48","field":"title"},{"relation":"75c8a58d5abe6bc1c44b5c6732ae8e48","field":"author"},{"relation":"210446682bb49afb05aad68eb78b4d4a","field":"copy_count"},{"relation":"210446682bb49afb05aad68eb78b4d4a","field":"hold_copy_ratio"}],"210446682bb49afb05aad68eb78b4d4a":{"label":"Hold/Copy Ratio per Bib","alias":"210446682bb49afb05aad68eb78b4d4a","path":"rhcrpb","join":"","reltype":"","idlclass":"rhcrpb","table":"(\\n\\n            -- -- If we uncomment the RIGHT JOIN against biblio.record_entry, then well get a row for every non-deleted bib, whether it has active holds or not.\\n            -- -- If we expect to use pcrud to query against specific bibs, we probably want to do this.  However, if were using this to populate a report, we\\n            -- -- may not.\\n            -- SELECT\\n            --     bre.id AS \\"bib_id\\",\\n            --     COALESCE( z.copy_count, 0 ) AS \\"copy_count\\",\\n            --     COALESCE( z.hold_count, 0 ) AS \\"hold_count\\",\\n            --     COALESCE( z.copy_hold_ratio, 0 ) AS \\"hold_copy_ratio\\"\\n            -- FROM (\\n                SELECT\\n                    y.bre AS \\"id\\",\\n                    COALESCE( x.copy_count, 0 ) AS \\"copy_count\\",\\n                    y.hold_count AS \\"hold_count\\",\\n                    (y.hold_count::REAL / (CASE WHEN x.copy_count = 0 OR x.copy_count IS NULL THEN 0.1 ELSE x.copy_count::REAL END)) AS \\"hold_copy_ratio\\"\\n                FROM (\\n                        SELECT\\n                            (SELECT bib_record FROM reporter.hold_request_record r WHERE r.id = h.id LIMIT 1) AS \\"bre\\",\\n                            COUNT(*) AS \\"hold_count\\"\\n                        FROM action.hold_request h\\n                        WHERE\\n                            cancel_time IS NULL\\n                            AND fulfillment_time IS NULL\\n                            -- AND NOT frozen  -- a frozen hold is still a desired hold, eh?\\n                        GROUP BY 1\\n                    )y LEFT JOIN (\\n                        SELECT \\n                            (SELECT id\\n                                FROM biblio.record_entry \\n                                WHERE id = (SELECT record FROM asset.call_number WHERE id = call_number)\\n                            ) AS \\"bre\\", \\n                            COUNT(*) AS \\"copy_count\\"\\n                        FROM asset.copy\\n                            JOIN asset.copy_location loc ON (copy.location = loc.id AND loc.holdable)\\n                        WHERE copy.holdable \\n                            AND NOT copy.deleted \\n                            AND copy.status IN ( SELECT id FROM config.copy_status WHERE holdable ) \\n                        GROUP BY 1\\n                    )x ON x.bre = y.bre\\n                -- )z RIGHT JOIN (\\n                --     SELECT id\\n                --     FROM biblio.record_entry\\n                --     WHERE NOT deleted\\n                -- )bre ON (z.bib_id = bre.id)\\n                \\n\\n\\t\\t)","fields":{"dis_tab":{"copy_count":{"colname":"copy_count","transform":"count","aggregate":true,"params":null,"transform_label":"Count","alias":"Holdable Copy Count","join":"","datatype":"int","op":"=","op_label":"Equals","op_value":{}},"hold_copy_ratio":{"colname":"hold_copy_ratio","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Hold/Copy Ratio","join":"","datatype":"float","op":"=","op_label":"Equals","op_value":{}}},"filter_tab":{"hold_copy_ratio":{"colname":"hold_copy_ratio","transform":"Bare","aggregate":null,"params":null,"transform_label":"Raw Data","alias":"Hold/Copy Ratio","join":"","datatype":"float","op":">=","op_label":"Greater than or equal to","op_value":{}}},"aggfilter_tab":{}}}}}', (select f.id from reporter.template_folder f JOIN reporter.template_folder ff on (f.parent = ff.id) where ff.name='EG Custom Reports' and f.name='Acquisitions'));


COMMIT;



--
-- PostgreSQL database dump complete
--

